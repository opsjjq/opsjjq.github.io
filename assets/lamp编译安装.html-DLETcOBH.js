import{_ as a,c as n,e,o as l}from"./app-DtXLoKBz.js";const i={};function p(c,s){return l(),n("div",null,[...s[0]||(s[0]=[e(`<h1 id="lamp-编译安装" tabindex="-1"><a class="header-anchor" href="#lamp-编译安装"><span>LAMP 编译安装</span></a></h1><hr><h2 id="一、安装-mysql" tabindex="-1"><a class="header-anchor" href="#一、安装-mysql"><span>一、安装 MySQL</span></a></h2><h3 id="_1-安装需求" tabindex="-1"><a class="header-anchor" href="#_1-安装需求"><span>1. 安装需求</span></a></h3><table><thead><tr><th style="text-align:left;">软件版本</th><th style="text-align:left;">安装目录</th><th style="text-align:left;">数据目录</th><th style="text-align:left;">端口</th></tr></thead><tbody><tr><td style="text-align:left;">mysql-5.6.51</td><td style="text-align:left;">/usr/local/mysql</td><td style="text-align:left;">/usr/local/mysql/data</td><td style="text-align:left;">3306</td></tr></tbody></table><h3 id="_2-安装步骤" tabindex="-1"><a class="header-anchor" href="#_2-安装步骤"><span>2. 安装步骤</span></a></h3><h4 id="_2-1-创建-mysql-用户" tabindex="-1"><a class="header-anchor" href="#_2-1-创建-mysql-用户"><span>2.1 创建 mysql 用户</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">useradd</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-s</span> /sbin/nologin mysql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-2-解压软件并进入解压后的目录" tabindex="-1"><a class="header-anchor" href="#_2-2-解压软件并进入解压后的目录"><span>2.2 解压软件并进入解压后的目录</span></a></h4><p>源码搜索地址：https://repo.huaweicloud.com/mysql/Downloads/MySQL-5.6/</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">cd</span> /usr/local/</span>
<span class="line"><span class="token function">mkdir</span> software-mysql</span>
<span class="line"><span class="token builtin class-name">cd</span> software-mysql/</span>
<span class="line">yum <span class="token function">install</span> <span class="token function">wget</span> <span class="token parameter variable">-y</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 下载源码</span></span>
<span class="line"><span class="token function">wget</span> <span class="token parameter variable">-c</span> https://repo.huaweicloud.com/mysql/Downloads/MySQL-5.6/mysql-5.6.50.tar.gz</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 解压缩</span></span>
<span class="line"><span class="token function">tar</span> <span class="token parameter variable">-zxf</span> mysql-5.6.50.tar.gz</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看解压文件夹大小</span></span>
<span class="line"><span class="token function">du</span> <span class="token parameter variable">-sh</span> *</span>
<span class="line"><span class="token comment"># 282M    mysql-5.6.50</span></span>
<span class="line"><span class="token comment"># 31M     mysql-5.6.50.tar.gz</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-创建目录" tabindex="-1"><a class="header-anchor" href="#_2-3-创建目录"><span>2.3 创建目录</span></a></h4><p>修改编译参数，如安装到指定位置。</p><h4 id="_2-4-根据需求配置编译参数" tabindex="-1"><a class="header-anchor" href="#_2-4-根据需求配置编译参数"><span>2.4 根据需求配置编译参数</span></a></h4><p>创建编译脚本 <code>cmake.sh</code>，设置编译参数：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">cmake <span class="token builtin class-name">.</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DCMAKE_INSTALL_PREFIX</span><span class="token operator">=</span>/usr/local/mysql/ <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DMYSQL_DATADIR</span><span class="token operator">=</span>/usr/local/mysql/data <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DENABLED_LOCAL_INFILE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DWITH_INNOBASE_STORAGE_ENGINE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DMYSQL_TCP_PORT</span><span class="token operator">=</span><span class="token number">3306</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DDEFAULT_CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DDEFAULT_COLLATION</span><span class="token operator">=</span>utf8mb4_general_ci <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DWITH_EXTRA_CHARSETS</span><span class="token operator">=</span>all <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-DMYSQL_USER</span><span class="token operator">=</span>mysql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>添加执行权限并执行：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">chmod</span> +x cmake.sh</span>
<span class="line">./cmake.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-5-编译并安装-耗时较长" tabindex="-1"><a class="header-anchor" href="#_2-5-编译并安装-耗时较长"><span>2.5 编译并安装（耗时较长）</span></a></h4><p>安装前 <code>/usr/local/mysql</code> 尚不存在，安装结束后会自动生成。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-6-配置-mysql-的-path-变量" tabindex="-1"><a class="header-anchor" href="#_2-6-配置-mysql-的-path-变量"><span>2.6 配置 mysql 的 PATH 变量</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&#39;export PATH=$PATH:/usr/local/mysql/bin/&#39;</span> <span class="token operator">&gt;&gt;</span> /etc/profile</span>
<span class="line"><span class="token builtin class-name">source</span> /etc/profile</span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span></span>
<span class="line"><span class="token comment"># 输出应包含：/usr/local/mysql/bin/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-7-关于-mysql-的客户端登录命令" tabindex="-1"><a class="header-anchor" href="#_2-7-关于-mysql-的客户端登录命令"><span>2.7 关于 mysql 的客户端登录命令</span></a></h4><p>总结如下报错，原因是？<strong>mysql没启动</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token punctuation">[</span>lamp-server root ~<span class="token punctuation">]</span><span class="token variable">$mysql</span> <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span></span>
<span class="line">Enter password:</span>
<span class="line">ERROR <span class="token number">2002</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Can<span class="token string">&#39;t connect to local MySQL server through socket &#39;</span>/tmp/mysql.sock&#39; <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Linux 的软件启动后，可以有 2 种形式提供客户端去访问：</p><ol><li><strong>IP:Port 形式</strong>：如 0.0.0.0:3306，网络连接方式</li><li><strong>Socket 本地套接字文件形式</strong>：本地进程套接字文件，启动 mysql，提供它的本地连接进程文件 <code>/tmp/mysql.sock</code></li></ol><p>只要这个文件存在，说明 mysql 是启动的。</p><h4 id="_2-8-修改-mysql-文件夹属组属主" tabindex="-1"><a class="header-anchor" href="#_2-8-修改-mysql-文件夹属组属主"><span>2.8 修改 mysql 文件夹属组属主</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">chown</span> <span class="token parameter variable">-R</span> mysql:mysql /usr/local/mysql/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-9-数据库初始化" tabindex="-1"><a class="header-anchor" href="#_2-9-数据库初始化"><span>2.9 数据库初始化</span></a></h4><p>mysql 设置账号密码，得有一个库，数据表得存储吧。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 检查是否有旧的 mysql 数据文件残留</span></span>
<span class="line"><span class="token comment"># 移除当前的 mysql 配置文件，/etc/my.cnf</span></span>
<span class="line"><span class="token function">mv</span> /etc/my.cnf /etc/my.cnf.bak</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用初始化 mysql 数据命令操作</span></span>
<span class="line"><span class="token builtin class-name">cd</span> /usr/local/mysql</span>
<span class="line">./scripts/mysql_install_db <span class="token parameter variable">--user</span><span class="token operator">=</span>mysql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-10-手动创建启动脚本" tabindex="-1"><a class="header-anchor" href="#_2-10-手动创建启动脚本"><span>2.10 手动创建启动脚本</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 方式一：使用 service 命令</span></span>
<span class="line"><span class="token function">service</span> mysql status</span>
<span class="line"><span class="token function">service</span> mysql start</span>
<span class="line"><span class="token comment"># Starting MySQL.Logging to &#39;/usr/local/mysql/data/xxx.err&#39;.</span></span>
<span class="line"><span class="token comment"># [OK]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 方式二：查看监听端口</span></span>
<span class="line"><span class="token function">netstat</span> <span class="token parameter variable">-tunlp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">3306</span></span>
<span class="line"><span class="token comment"># tcp6  0  0 :::3306  :::*  LISTEN  4177/mysqld</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-11-修改-mysql-密码" tabindex="-1"><a class="header-anchor" href="#_2-11-修改-mysql-密码"><span>2.11 修改 mysql 密码</span></a></h4><p><strong>忘记 mysql 密码</strong>：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">service</span> mysql stop</span>
<span class="line"><span class="token function">service</span> mysql start --skip-grant-tables</span>
<span class="line">mysql <span class="token parameter variable">-uroot</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token comment">-- MySQL 8.0：</span></span>
<span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">&#39;root&#39;</span><span class="token variable">@&#39;localhost&#39;</span> IDENTIFIED <span class="token keyword">WITH</span> mysql_native_password <span class="token keyword">BY</span> <span class="token string">&#39;新密码&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- MySQL 5.7：</span></span>
<span class="line"><span class="token keyword">UPDATE</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">SET</span> authentication_string <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">&#39;新密码&#39;</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">+</span><span class="token comment">-----------+</span></span>
<span class="line"><span class="token operator">|</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span></span>
<span class="line"><span class="token operator">+</span><span class="token comment">-----------+</span></span>
<span class="line"><span class="token operator">|</span> <span class="token number">5.6</span><span class="token number">.51</span>    <span class="token operator">|</span></span>
<span class="line"><span class="token operator">+</span><span class="token comment">-----------+</span></span>
<span class="line"><span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="二、编译安装-apache" tabindex="-1"><a class="header-anchor" href="#二、编译安装-apache"><span>二、编译安装 Apache</span></a></h2><h3 id="_1-安装依赖包-apr" tabindex="-1"><a class="header-anchor" href="#_1-安装依赖包-apr"><span>1. 安装依赖包 apr</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">cd</span> /usr/local/software-apache</span>
<span class="line"><span class="token function">wget</span> <span class="token parameter variable">-c</span> http://archive.apache.org/dist/apr/apr-1.5.2.tar.bz2</span>
<span class="line"><span class="token function">tar</span> <span class="token parameter variable">-xf</span> apr-1.5.2.tar.bz2</span>
<span class="line"><span class="token builtin class-name">cd</span> apr-1.5.2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可能由于其 1.5.2 的 bug，存在一个配置错误，需要修改如下配置：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">vim</span> configure</span>
<span class="line"><span class="token comment"># 修改第 29605 行</span></span>
<span class="line"><span class="token comment"># RM=&#39;$RM -f&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">./configure</span>
<span class="line"><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-编译安装-apr-util" tabindex="-1"><a class="header-anchor" href="#_2-编译安装-apr-util"><span>2. 编译安装 apr-util</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">wget</span> <span class="token parameter variable">-c</span> https://archive.apache.org/dist/apr/apr-util-1.5.4.tar.bz2</span>
<span class="line"><span class="token function">tar</span> <span class="token parameter variable">-xf</span> apr-util-1.5.4.tar.bz2</span>
<span class="line"><span class="token builtin class-name">cd</span> apr-util-1.5.4</span>
<span class="line">./configure --with-apr<span class="token operator">=</span>/usr/local/apr/bin/apr-1-config</span>
<span class="line"><span class="token function">make</span></span>
<span class="line"><span class="token function">make</span> <span class="token function">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将 apr 工具写入系统的动态库配置文件中：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&quot;/usr/local/apr/lib/&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/ld.so.conf</span>
<span class="line">ldconfig</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-编译-apache" tabindex="-1"><a class="header-anchor" href="#_3-编译-apache"><span>3. 编译 Apache</span></a></h3><p>Apache 或 Nginx 都提供了模块的概念，所有的功能都是以模块、插件的形式提供的。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">wget</span> https://archive.apache.org/dist/httpd/httpd-2.4.37.tar.bz2</span>
<span class="line"><span class="token function">tar</span> <span class="token parameter variable">-xf</span> httpd-2.4.37.tar.bz2</span>
<span class="line"><span class="token builtin class-name">cd</span> httpd-2.4.37</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建配置脚本 <code>config.sh</code>：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">cat</span> <span class="token operator">&gt;</span> config.sh <span class="token operator">&lt;&lt;</span> <span class="token string">&#39;EOF&#39;</span>
<span class="line">./configure \\</span>
<span class="line">--enable-modules=all \\</span>
<span class="line">--enable-mods-shared=all \\</span>
<span class="line">--enable-so \\</span>
<span class="line">--enable-rewrite \\</span>
<span class="line">--with-pcre \\</span>
<span class="line">--enable-ssl \\</span>
<span class="line">--with-mpm=prefork \\</span>
<span class="line">--with-apr=/usr/local/apr/bin/apr-1-config \\</span>
<span class="line">--with-apr-util=/usr/local/apr/bin/apu-1-config</span>
<span class="line">EOF</span></span>
<span class="line"></span>
<span class="line"><span class="token function">chmod</span> +x config.sh</span>
<span class="line">./config.sh</span>
<span class="line"><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-检查-apache-安装路径" tabindex="-1"><a class="header-anchor" href="#_4-检查-apache-安装路径"><span>4. 检查 Apache 安装路径</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">ls</span> /usr/local/apache2/</span>
<span class="line"><span class="token comment"># bin  build  cgi-bin  conf  error  htdocs  icons  include  logs  man  manual  modules</span></span>
<span class="line"></span>
<span class="line"><span class="token function">ls</span> /usr/local/apache2/bin/</span>
<span class="line"><span class="token comment"># ab  apxs  dbmmanage  envvars-std  htcacheclean  htdigest  httpd  logresolve</span></span>
<span class="line"><span class="token comment"># apachectl  checkgid  envvars  fcgistarter  htdbm  htpasswd  httxt2dbm  rotatelogs</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="三、安装-php" tabindex="-1"><a class="header-anchor" href="#三、安装-php"><span>三、安装 PHP</span></a></h2><h3 id="_1-安装依赖文件" tabindex="-1"><a class="header-anchor" href="#_1-安装依赖文件"><span>1. 安装依赖文件</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">yum <span class="token function">install</span> libxml2-devel libjpeg-devel libpng-devel freetype-devel libcurl-devel <span class="token parameter variable">-y</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-下载解压" tabindex="-1"><a class="header-anchor" href="#_2-下载解压"><span>2. 下载解压</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">wget</span> <span class="token parameter variable">-c</span> https://museum.php.net/php7/php-7.2.17.tar.xz</span>
<span class="line"><span class="token function">tar</span> <span class="token parameter variable">-xf</span> php-7.2.17.tar.xz</span>
<span class="line"><span class="token builtin class-name">cd</span> php-7.2.17</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-创建编译配置脚本" tabindex="-1"><a class="header-anchor" href="#_3-创建编译配置脚本"><span>3. 创建编译配置脚本</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">cat</span> <span class="token operator">&gt;</span> configure_php.sh <span class="token operator">&lt;&lt;</span> <span class="token string">&#39;EOF&#39;</span>
<span class="line">./configure \\</span>
<span class="line">--with-apxs2=/usr/local/apache2/bin/apxs \\</span>
<span class="line">--with-mysqli \\</span>
<span class="line">--with-pdo-mysql \\</span>
<span class="line">--with-zlib \\</span>
<span class="line">--with-curl \\</span>
<span class="line">--enable-zip \\</span>
<span class="line">--with-gd \\</span>
<span class="line">--with-freetype-dir \\</span>
<span class="line">--with-jpeg-dir \\</span>
<span class="line">--with-png-dir \\</span>
<span class="line">--enable-sockets \\</span>
<span class="line">--with-xmlrpc \\</span>
<span class="line">--enable-soap \\</span>
<span class="line">--enable-opcache \\</span>
<span class="line">--enable-mbstring \\</span>
<span class="line">--enable-mbregex \\</span>
<span class="line">--enable-pcntl \\</span>
<span class="line">--enable-shmop \\</span>
<span class="line">--enable-sysvmsg \\</span>
<span class="line">--enable-sysvsem \\</span>
<span class="line">--enable-sysvshm \\</span>
<span class="line">--enable-calendar \\</span>
<span class="line">--enable-bcmath</span>
<span class="line">EOF</span></span>
<span class="line"></span>
<span class="line"><span class="token function">chmod</span> +x configure_php.sh</span>
<span class="line">./configure_php.sh</span>
<span class="line"><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="四、配置-apache-与-php-整合" tabindex="-1"><a class="header-anchor" href="#四、配置-apache-与-php-整合"><span>四、配置 Apache 与 PHP 整合</span></a></h2><h3 id="_1-修改-apache-主配置文件-httpd-conf" tabindex="-1"><a class="header-anchor" href="#_1-修改-apache-主配置文件-httpd-conf"><span>1. 修改 Apache 主配置文件 httpd.conf</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">vim</span> /usr/local/apache2/conf/httpd.conf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol><li><p><strong>配置语言支持</strong></p><div class="language-apache line-numbers-mode" data-highlighter="prismjs" data-ext="apache"><pre><code class="language-apache"><span class="line"># 159 行：LoadModule negotiation_module modules/mod_negotiation.so 去掉注释</span>
<span class="line"># 482 行：Include conf/extra/httpd-languages.conf 打开此选项</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>加载 PHP 模块</strong></p><div class="language-apache line-numbers-mode" data-highlighter="prismjs" data-ext="apache"><pre><code class="language-apache"><span class="line"># 166 行：LoadModule php7_module modules/libphp7.so</span>
<span class="line"># 下面添加：</span>
<span class="line">AddHandler php7-script .php</span>
<span class="line">AddType text/html .php</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>配置默认首页</strong></p><div class="language-apache line-numbers-mode" data-highlighter="prismjs" data-ext="apache"><pre><code class="language-apache"><span class="line">&lt;IfModule dir_module&gt;</span>
<span class="line">    DirectoryIndex index.php index.html</span>
<span class="line">&lt;/IfModule&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>配置网站根目录</strong></p><div class="language-apache line-numbers-mode" data-highlighter="prismjs" data-ext="apache"><pre><code class="language-apache"><span class="line">DocumentRoot &quot;/usr/local/apache2/htdocs&quot;</span>
<span class="line">&lt;Directory &quot;/usr/local/apache2/htdocs&quot;&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_2-修改-apache-的子配置文件-httpd-languages-conf" tabindex="-1"><a class="header-anchor" href="#_2-修改-apache-的子配置文件-httpd-languages-conf"><span>2. 修改 Apache 的子配置文件 httpd-languages.conf</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">vim</span> /usr/local/apache2/conf/extra/httpd-languages.conf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-apache line-numbers-mode" data-highlighter="prismjs" data-ext="apache"><pre><code class="language-apache"><span class="line"># 19 行</span>
<span class="line">DefaultLanguage zh-CN</span>
<span class="line"></span>
<span class="line"># 78 行</span>
<span class="line">LanguagePriority zh-CN en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv tr zh-CN zh-TW</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-启动-apache" tabindex="-1"><a class="header-anchor" href="#_3-启动-apache"><span>3. 启动 Apache</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 复制启动脚本</span></span>
<span class="line"><span class="token function">cp</span> /usr/local/apache2/bin/apachectl /etc/init.d/apache</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 启动服务</span></span>
<span class="line"><span class="token function">service</span> apache start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-问题排查" tabindex="-1"><a class="header-anchor" href="#_4-问题排查"><span>4. 问题排查</span></a></h3><p>使用 <code>/usr/local/apache2/bin/apachectl -t</code> 命令检查配置：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">AH00558: httpd: Could not reliably determine the server&#39;s fully qualified domain name, using localhost.localdomain. Set the &#39;ServerName&#39; directive globally to suppress this message</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>解决方法</strong>：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">vim</span> /usr/local/apache2/conf/httpd.conf</span>
<span class="line"><span class="token comment"># 添加：</span></span>
<span class="line">ServerName localhost:80</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 重新检查</span></span>
<span class="line">/usr/local/apache2/bin/apachectl <span class="token parameter variable">-t</span></span>
<span class="line"><span class="token comment"># Syntax OK</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="五、实践部署-wordpress" tabindex="-1"><a class="header-anchor" href="#五、实践部署-wordpress"><span>五、实践部署 WordPress</span></a></h2><h3 id="_1-下载安装" tabindex="-1"><a class="header-anchor" href="#_1-下载安装"><span>1. 下载安装</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">wget</span> https://cn.wordpress.org/wordpress-5.9-zh_CN.tar.gz</span>
<span class="line"><span class="token function">tar</span> <span class="token parameter variable">-xzf</span> wordpress-5.9-zh_CN.tar.gz</span>
<span class="line"><span class="token function">mv</span> wordpress /usr/local/apache2/htdocs/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-访问安装" tabindex="-1"><a class="header-anchor" href="#_2-访问安装"><span>2. 访问安装</span></a></h3><p>浏览器访问：<code>http://服务器IP/wordpress</code></p><p>按照向导填写数据库信息完成安装。</p>`,89)])])}const r=a(i,[["render",p]]),d=JSON.parse('{"path":"/04-Web%E6%9E%B6%E6%9E%84/01-lamp%E6%9E%B6%E6%9E%84/lamp%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85.html","title":"LAMP 编译安装","lang":"zh-CN","frontmatter":{},"git":{"contributors":[{"name":"opsjjq","username":"opsjjq","email":"wangyp987@gmail.com","commits":1,"url":"https://github.com/opsjjq"}],"changelog":[{"hash":"ca8e661b7c6729c958583ed3d1a001b6de398273","time":1771558748000,"email":"wangyp987@gmail.com","author":"opsjjq","message":"222"}]},"filePathRelative":"04-Web架构/01-lamp架构/lamp编译安装.md"}');export{r as comp,d as data};
