import{_ as e,c as a,e as n,o as s}from"./app-DtXLoKBz.js";const l={};function i(d,t){return s(),a("div",null,[...t[0]||(t[0]=[n(`<h1 id="cdn-内容分发网络实践指南" tabindex="-1"><a class="header-anchor" href="#cdn-内容分发网络实践指南"><span>CDN 内容分发网络实践指南</span></a></h1><hr><h2 id="一、cdn-基础概念" tabindex="-1"><a class="header-anchor" href="#一、cdn-基础概念"><span>一、CDN 基础概念</span></a></h2><h3 id="_1-什么是-cdn" tabindex="-1"><a class="header-anchor" href="#_1-什么是-cdn"><span>1. 什么是 CDN？</span></a></h3><p>CDN（Content Delivery Network）通过在各地部署边缘节点服务器，使用户就近获取所需内容，提高访问速度和稳定性的网络架构。</p><h3 id="_2-cdn-核心功能" tabindex="-1"><a class="header-anchor" href="#_2-cdn-核心功能"><span>2. CDN 核心功能</span></a></h3><table><thead><tr><th style="text-align:left;">功能</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>缓存静态资源</strong></td><td style="text-align:left;">图片、CSS、JS、视频等</td></tr><tr><td style="text-align:left;"><strong>减轻源站压力</strong></td><td style="text-align:left;">分散访问流量</td></tr><tr><td style="text-align:left;"><strong>提升用户体验</strong></td><td style="text-align:left;">就近访问、速度更快</td></tr><tr><td style="text-align:left;"><strong>提高可用性</strong></td><td style="text-align:left;">多节点冗余、故障转移</td></tr></tbody></table><h3 id="_3-cdn-重要性" tabindex="-1"><a class="header-anchor" href="#_3-cdn-重要性"><span>3. CDN 重要性</span></a></h3><ul><li>降低服务器负载</li><li>提升访问速度</li><li>提升网站稳定性</li><li>支持高并发访问</li></ul><h3 id="_4-cdn-工作原理" tabindex="-1"><a class="header-anchor" href="#_4-cdn-工作原理"><span>4. CDN 工作原理</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">用户请求 → DNS 解析（返回 CNAME）→ 就近 CDN 节点</span>
<span class="line">                                    ↓</span>
<span class="line">                          命中缓存 → 直接返回</span>
<span class="line">                                    ↓</span>
<span class="line">                          未命中缓存 → 回源拉取 → 返回并缓存</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>详细流程</strong>：</p><ol><li>用户访问已接入 CDN 的域名（如 <code>alicdn.apecome.com</code>）</li><li>DNS 解析返回 CNAME 记录，指向 CDN 服务商提供的域名</li><li>请求被调度到最近的 CDN 节点</li><li>节点如有缓存则直接返回，否则回源拉取并缓存</li></ol><hr><h2 id="二、web-通信协议基础" tabindex="-1"><a class="header-anchor" href="#二、web-通信协议基础"><span>二、Web 通信协议基础</span></a></h2><h3 id="_1-tcp-ip-协议" tabindex="-1"><a class="header-anchor" href="#_1-tcp-ip-协议"><span>1. TCP/IP 协议</span></a></h3><p>互联网通信的基础协议簇，包含 TCP（传输控制协议）和 IP（网际协议）。</p><h3 id="_2-osi-七层模型" tabindex="-1"><a class="header-anchor" href="#_2-osi-七层模型"><span>2. OSI 七层模型</span></a></h3><table><thead><tr><th style="text-align:left;">层级</th><th style="text-align:left;">名称</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">7</td><td style="text-align:left;">应用层</td><td style="text-align:left;">HTTP、FTP、SMTP</td></tr><tr><td style="text-align:left;">6</td><td style="text-align:left;">表示层</td><td style="text-align:left;">数据格式转换、加密</td></tr><tr><td style="text-align:left;">5</td><td style="text-align:left;">会话层</td><td style="text-align:left;">会话管理</td></tr><tr><td style="text-align:left;">4</td><td style="text-align:left;">传输层</td><td style="text-align:left;">TCP、UDP（端口）</td></tr><tr><td style="text-align:left;">3</td><td style="text-align:left;">网络层</td><td style="text-align:left;">IP 寻址、路由</td></tr><tr><td style="text-align:left;">2</td><td style="text-align:left;">数据链路层</td><td style="text-align:left;">MAC 地址、帧</td></tr><tr><td style="text-align:left;">1</td><td style="text-align:left;">物理层</td><td style="text-align:left;">物理介质、信号</td></tr></tbody></table><h3 id="_3-http-协议特性" tabindex="-1"><a class="header-anchor" href="#_3-http-协议特性"><span>3. HTTP 协议特性</span></a></h3><table><thead><tr><th style="text-align:left;">特性</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>无状态</strong></td><td style="text-align:left;">每次请求独立，服务器不记录之前状态</td></tr><tr><td style="text-align:left;"><strong>Cookie</strong></td><td style="text-align:left;">维持会话状态</td></tr><tr><td style="text-align:left;"><strong>请求方法</strong></td><td style="text-align:left;">GET、POST、PUT、DELETE 等</td></tr></tbody></table><h3 id="_4-请求与响应结构" tabindex="-1"><a class="header-anchor" href="#_4-请求与响应结构"><span>4. 请求与响应结构</span></a></h3><table><thead><tr><th style="text-align:left;">报文类型</th><th style="text-align:left;">组成部分</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>请求报文</strong></td><td style="text-align:left;">请求行、请求头、请求体</td></tr><tr><td style="text-align:left;"><strong>响应报文</strong></td><td style="text-align:left;">状态行、响应头、响应体</td></tr></tbody></table><h3 id="_5-端口号与-socket" tabindex="-1"><a class="header-anchor" href="#_5-端口号与-socket"><span>5. 端口号与 Socket</span></a></h3><table><thead><tr><th style="text-align:left;">概念</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>端口号</strong></td><td style="text-align:left;">区分同一主机上的不同服务</td></tr><tr><td style="text-align:left;"><strong>Socket</strong></td><td style="text-align:left;">IP 地址 + 端口号，标识网络通信端点</td></tr></tbody></table><h3 id="_6-资源类型对比" tabindex="-1"><a class="header-anchor" href="#_6-资源类型对比"><span>6. 资源类型对比</span></a></h3><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>静态资源</strong></td><td style="text-align:left;">直接由 Web 服务器返回</td><td style="text-align:left;">图片、CSS、JS、HTML</td></tr><tr><td style="text-align:left;"><strong>动态资源</strong></td><td style="text-align:left;">需后端程序处理生成</td><td style="text-align:left;">PHP、Python、Java 输出</td></tr></tbody></table><hr><h2 id="三、cdn-配置与优化" tabindex="-1"><a class="header-anchor" href="#三、cdn-配置与优化"><span>三、CDN 配置与优化</span></a></h2><h3 id="_1-判断是否使用-cdn" tabindex="-1"><a class="header-anchor" href="#_1-判断是否使用-cdn"><span>1. 判断是否使用 CDN</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 方法1：Ping 命令查看 CNAME</span></span>
<span class="line"><span class="token function">ping</span> gw.alicdn.com</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 方法2：dig 命令查看解析结果</span></span>
<span class="line"><span class="token function">dig</span> www.taobao.com</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 方法3：查看响应头标识</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">-I</span> https://www.example.com</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-cdn-缓存策略" tabindex="-1"><a class="header-anchor" href="#_2-cdn-缓存策略"><span>2. CDN 缓存策略</span></a></h3><table><thead><tr><th style="text-align:left;">策略</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>缓存过期时间</strong></td><td style="text-align:left;">设置合理的 TTL，避免用户访问旧数据</td></tr><tr><td style="text-align:left;"><strong>主动刷新</strong></td><td style="text-align:left;">资源更新时主动清除缓存</td></tr><tr><td style="text-align:left;"><strong>缓存分层</strong></td><td style="text-align:left;">浏览器缓存 + CDN 边缘缓存</td></tr></tbody></table><h3 id="_3-cdn-防盗链配置" tabindex="-1"><a class="header-anchor" href="#_3-cdn-防盗链配置"><span>3. CDN 防盗链配置</span></a></h3><p><strong>目的</strong>：防止其他网站盗用本站静态资源（如图片）。</p><p><strong>实现方式</strong>：检查请求头中的 <code>Referer</code> 字段，只允许指定域名访问。</p><div class="language-nginx line-numbers-mode" data-highlighter="prismjs" data-ext="nginx"><pre><code class="language-nginx"><span class="line"><span class="token comment"># Nginx 防盗链配置示例</span></span>
<span class="line"><span class="token directive"><span class="token keyword">location</span> ~* \\.(jpg|png|gif)$</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">valid_referers</span> none blocked example.com *.example.com</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$invalid_referer</span>)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">return</span> <span class="token number">403</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="四、阿里云-cdn-实践步骤" tabindex="-1"><a class="header-anchor" href="#四、阿里云-cdn-实践步骤"><span>四、阿里云 CDN 实践步骤</span></a></h2><h3 id="_1-准备工作" tabindex="-1"><a class="header-anchor" href="#_1-准备工作"><span>1. 准备工作</span></a></h3><table><thead><tr><th style="text-align:left;">准备项</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">源站服务器</td><td style="text-align:left;">Nginx 或其他 Web 服务器</td></tr><tr><td style="text-align:left;">源站域名</td><td style="text-align:left;">可访问的域名（如 <code>alicdn.apecome.com</code>）</td></tr><tr><td style="text-align:left;">CDN 服务</td><td style="text-align:left;">阿里云 CDN 控制台账号</td></tr></tbody></table><h3 id="_2-创建加速域名" tabindex="-1"><a class="header-anchor" href="#_2-创建加速域名"><span>2. 创建加速域名</span></a></h3><ol><li>登录阿里云 CDN 控制台</li><li>添加加速域名</li><li>配置源站信息（IP 或域名）</li><li>选择加速区域</li></ol><h3 id="_3-配置-cname" tabindex="-1"><a class="header-anchor" href="#_3-配置-cname"><span>3. 配置 CNAME</span></a></h3><ol><li>获取阿里云 CDN 提供的 CNAME 域名</li><li>修改 DNS 解析</li><li>将加速域名的 A 记录改为 CNAME 记录</li></ol><h3 id="_4-验证-cdn-生效" tabindex="-1"><a class="header-anchor" href="#_4-验证-cdn-生效"><span>4. 验证 CDN 生效</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 检查 DNS 解析结果</span></span>
<span class="line"><span class="token function">dig</span> www.yourdomain.com</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 访问加速域名，查看响应头</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">-I</span> https://www.yourdomain.com</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 确认响应头包含 CDN 标识</span></span>
<span class="line"><span class="token comment"># X-Cache: HIT from ...</span></span>
<span class="line"><span class="token comment"># Server: AlibabaCloud</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,47)])])}const c=e(l,[["render",i]]),p=JSON.parse('{"path":"/04-Web%E6%9E%B6%E6%9E%84/08-cdn/cdn.html","title":"CDN 内容分发网络实践指南","lang":"zh-CN","frontmatter":{},"git":{"contributors":[{"name":"opsjjq","username":"opsjjq","email":"wangyp987@gmail.com","commits":1,"url":"https://github.com/opsjjq"}],"changelog":[{"hash":"ca8e661b7c6729c958583ed3d1a001b6de398273","time":1771558748000,"email":"wangyp987@gmail.com","author":"opsjjq","message":"222"}]},"filePathRelative":"04-Web架构/08-cdn/cdn.md"}');export{c as comp,p as data};
