import{_ as n,c as a,e,o as l}from"./app-DtXLoKBz.js";const t={};function i(d,s){return l(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="关于-linux-三剑客" tabindex="-1"><a class="header-anchor" href="#关于-linux-三剑客"><span>关于 Linux 三剑客</span></a></h1><table><thead><tr><th style="text-align:left;">工具</th><th style="text-align:left;">擅长领域</th><th style="text-align:left;">特点</th><th style="text-align:left;">典型场景</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>grep</strong></td><td style="text-align:left;">查找匹配</td><td style="text-align:left;">快速过滤，正则匹配</td><td style="text-align:left;"><code>grep &quot;error&quot; logfile</code></td></tr><tr><td style="text-align:left;"><strong>sed</strong></td><td style="text-align:left;">编辑修改</td><td style="text-align:left;">流编辑，非交互式</td><td style="text-align:left;"><code>sed &#39;s/old/new/g&#39; file</code></td></tr><tr><td style="text-align:left;"><strong>awk</strong></td><td style="text-align:left;">格式化处理</td><td style="text-align:left;">字段处理，编程特性</td><td style="text-align:left;"><code>awk &#39;{print $1,$3}&#39; file</code></td></tr></tbody></table><h1 id="sed详解" tabindex="-1"><a class="header-anchor" href="#sed详解"><span>sed详解</span></a></h1><h2 id="sed语法" tabindex="-1"><a class="header-anchor" href="#sed语法"><span>sed语法</span></a></h2><h3 id="sed-选项-sed命令-数据源" tabindex="-1"><a class="header-anchor" href="#sed-选项-sed命令-数据源"><span>sed -选项 sed命令 数据源</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span>  <span class="token string">&#39;s/nameold/namenew/g&#39;</span> <span class="token function">file</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span>  <span class="token string">&#39;s/nameold/namenew/&#39;</span> <span class="token function">file</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span>  <span class="token string">&#39;/line1/a line2&#39;</span> <span class="token function">file</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span>  <span class="token string">&#39;/line1/i line0&#39;</span> <span class="token function">file</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span>  <span class="token string">&#39;/line9/d&#39;</span> <span class="token function">file</span> </span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span>  <span class="token string">&#39;/line6/c newline6&#39;</span> <span class="token function">file</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># a 是追加命令    \\ 表示命令会跨越多行   下一行开始才是要追加的内容</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/line1/a\\</span>
<span class="line">line2\\</span>
<span class="line">line3\\</span>
<span class="line">line4&#39;</span> <span class="token function">file</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="常用选项" tabindex="-1"><a class="header-anchor" href="#常用选项"><span>常用选项</span></a></h3><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">说明</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;"><code>-n</code></td><td style="text-align:left;">取消默认输出，配合<code>p</code>使用</td><td style="text-align:left;"><code>sed -n &#39;3p&#39; file</code></td></tr><tr><td style="text-align:left;"><code>-e</code></td><td style="text-align:left;">执行多条sed命令</td><td style="text-align:left;"><code>sed -e &#39;1d&#39; -e &#39;s/foo/bar/&#39; file</code></td></tr><tr><td style="text-align:left;"><code>-f</code></td><td style="text-align:left;">指定sed脚本文件</td><td style="text-align:left;"><code>sed -f script.sed file</code></td></tr><tr><td style="text-align:left;"><code>-r</code></td><td style="text-align:left;">使用扩展正则表达式</td><td style="text-align:left;"><code>sed -r &#39;s/(ab)+/CD/g&#39; file</code></td></tr><tr><td style="text-align:left;"><code>-i</code></td><td style="text-align:left;">直接修改源文件</td><td style="text-align:left;"><code>sed -i &#39;s/old/new/g&#39; file</code></td></tr><tr><td style="text-align:left;"><code>-i.bak</code></td><td style="text-align:left;">修改前备份原文件</td><td style="text-align:left;"><code>sed -i.bak &#39;s/old/new/g&#39; file</code></td></tr></tbody></table><h3 id="命令" tabindex="-1"><a class="header-anchor" href="#命令"><span>命令</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">a  追加，在指定行后添加一行或多行文本</span>
<span class="line">c  取代指定的行</span>
<span class="line">d  删除指定的行</span>
<span class="line">D  删除模式空间的部分内容，直到遇到换行符 \\n 结束操作，与多行模式相关</span>
<span class="line">i  插入，在指定的行前添加一行或多行文本</span>
<span class="line">h  把模式空间的内容复制到保持空间</span>
<span class="line">H  把模式空间的内容追加到保持空间</span>
<span class="line">g  把保持空间的内容复制到模式空间</span>
<span class="line">G  把保持空间的内容追加到模式空间</span>
<span class="line">x  交换模式空间和保持空间的内容</span>
<span class="line">l  打印不可见的字符</span>
<span class="line">n  清空模式空间，并读取下一行数据并追加到模式空间</span>
<span class="line">N  不清空模式空间，并读取下一行数据并追加到模式空间</span>
<span class="line">p  打印模式空间的内容，通常 p 会与选项 -n 一起使用</span>
<span class="line">P  打印模式空间的内容，直到遇到换行符结束操作</span>
<span class="line">q  退出 sed</span>
<span class="line">r  从指定文件读取数据</span>
<span class="line">s  取代，s#old#new#g，其中 g 是 s 命令的替代标志，注意和 g 命令区分</span>
<span class="line">w  另存，把模式空间的内容保存到文件中</span>
<span class="line">y  根据对应位置转换字符</span>
<span class="line">:label  定义一个标签</span>
<span class="line">t  如果前面的命令执行成功，则跳转到 t 指定的标签处继续执行，否则继续正常流程</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sed匹配" tabindex="-1"><a class="header-anchor" href="#sed匹配"><span>sed匹配</span></a></h2><h3 id="sed匹配是按行来匹配" tabindex="-1"><a class="header-anchor" href="#sed匹配是按行来匹配"><span>sed匹配是按行来匹配</span></a></h3><h3 id="sed匹配文本范围" tabindex="-1"><a class="header-anchor" href="#sed匹配文本范围"><span>sed匹配文本范围</span></a></h3><table><thead><tr><th>范围</th><th>解释</th></tr></thead><tbody><tr><td>空地址</td><td>全文处理</td></tr><tr><td>单地址</td><td>指定文件某一行</td></tr><tr><td><code>/pattern/</code></td><td>被模式匹配到的每一行 #写入正则，字符数据#</td></tr><tr><td>范围区间</td><td><code>10,20 十到二十行</code>，<code>10,+5第10行向下5行</code>，<code>/pattern1/,/pattern2/</code></td></tr><tr><td>步长</td><td><code>1~2，表示1、3、5、7、9行</code>，<code>2~2两个步长，表示2、4、6、8、10、偶数行</code></td></tr></tbody></table><h3 id="匹配行操作范围-关于sed处理文件行范围语法" tabindex="-1"><a class="header-anchor" href="#匹配行操作范围-关于sed处理文件行范围语法"><span>匹配行操作范围 关于sed处理文件行范围语法</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 单行定位</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;5{命令}&#39;</span> <span class="token function">file</span>              <span class="token comment"># 第5行</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;\${命令}&#39;</span> <span class="token function">file</span>             <span class="token comment"># 最后一行</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 范围定位</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;3,8{命令}&#39;</span> <span class="token function">file</span>            <span class="token comment"># 3-8行</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;10,+5{命令}&#39;</span> <span class="token function">file</span>          <span class="token comment"># 10-15行</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;3,\${命令}&#39;</span> <span class="token function">file</span>            <span class="token comment"># 第3行到末尾</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 模式匹配</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;/^root/{命令}&#39;</span> <span class="token function">file</span>        <span class="token comment"># 匹配以root开头的行</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;/start/,/end/{命令}&#39;</span> <span class="token function">file</span>  <span class="token comment"># start到end之间的行   指的是内容包含字符串</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 步长定位</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;1~2{命令}&#39;</span> <span class="token function">file</span>            <span class="token comment"># 奇数行(1,3,5...)</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;2~2{命令}&#39;</span> <span class="token function">file</span>            <span class="token comment"># 偶数行(2,4,6...)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 从第3行开始，每隔2行处理一次</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;3~2{命令}&#39;</span> <span class="token function">file</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 从匹配&quot;start&quot;的行到第10行</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;/start/,10{命令}&#39;</span> <span class="token function">file</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 从第5行到匹配&quot;end&quot;的行</span></span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;5,/end/{命令}&#39;</span> <span class="token function">file</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="sed实用" tabindex="-1"><a class="header-anchor" href="#sed实用"><span>sed实用</span></a></h1><h2 id="插入数据" tabindex="-1"><a class="header-anchor" href="#插入数据"><span>插入数据</span></a></h2><p>a指定行下一行添加</p><p>i指定行上一行添加</p><p>可使用\\n添加多行数据</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># SSH配置（多行插入）</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;1i\\# SSH安全配置\\nPort 25515\\nPermitRootLogin no\\nPermitEmptyPasswords no\\nUseDNS no\\nGSSAPIAuthentication no&#39;</span> /etc/ssh/sshd_config</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="删除行" tabindex="-1"><a class="header-anchor" href="#删除行"><span>删除行</span></a></h2><p>对匹配到的行进行删除操作</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">删除第三行数据</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;3 d&#39;</span>  t1.log</span>
<span class="line"></span>
<span class="line">删除文件的3到6行</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;3,6 d&#39;</span> t1.log</span>
<span class="line"></span>
<span class="line">删除第三行开始，向下2行</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;3,+2 d&#39;</span>  t1.log</span>
<span class="line"></span>
<span class="line">删除奇数行 <span class="token number">1,3</span>,5,7,9</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;1~2 d&#39;</span> t1.log</span>
<span class="line"></span>
<span class="line">删除偶数行 <span class="token number">2,4</span>,6,8</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;2~2 d&#39;</span> t1.log</span>
<span class="line"></span>
<span class="line">保留前三行</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;4,$ d&#39;</span>  t1.log </span>
<span class="line"></span>
<span class="line">找到game那一行，且删掉</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;/game/ d&#39;</span> t1.log</span>
<span class="line"></span>
<span class="line">删除game这一行到结尾</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;/game/,$ d&#39;</span>  t1.log </span>
<span class="line"></span>
<span class="line">删除文件中所有包含game的行，以及它下一行</span>
<span class="line"><span class="token function">sed</span> <span class="token string">&#39;/game/,+1 d&#39;</span> t1.log </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改" tabindex="-1"><a class="header-anchor" href="#修改"><span>修改</span></a></h2><p>(包括了替换)</p><p>修改数据，是一大重点，因为我们需要用sed来修改各种配置文件，sed这种非交互式修改文件内容，在脚本中实现自动化修改是最常见的。</p><p>如修改nginx的端口；</p><p>修改mysql的数据存储路径；</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Nginx端口修改</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/listen 80;/listen 8080;/&#39;</span> /etc/nginx/nginx.conf</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 注释/取消注释行</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/^server_name/s/^/#/&#39;</span> nginx.conf      <span class="token comment"># 注释</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/^#server_name/s/^#//&#39;</span> nginx.conf     <span class="token comment"># 取消注释</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查询" tabindex="-1"><a class="header-anchor" href="#查询"><span>查询</span></a></h2><h3 id="分组取出ip" tabindex="-1"><a class="header-anchor" href="#分组取出ip"><span>分组取出ip</span></a></h3><p>按正则匹配内容打印行</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">去头  去尾</span>
<span class="line"><span class="token function">ifconfig</span> eth0 <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;2s/^.*inet //&#39;</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;2s/netmask.*//p&#39;</span> <span class="token parameter variable">-n</span> </span>
<span class="line"></span>
<span class="line">分组提取法</span>
<span class="line"><span class="token function">ifconfig</span> eth0 <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-r</span> <span class="token string">&#39;2s/^.*t (.*)n.*/\\1/p&#39;</span> <span class="token parameter variable">-n</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="日志处理" tabindex="-1"><a class="header-anchor" href="#日志处理"><span>日志处理</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">&#39;/2025-10-01 10:00:00/,/2025-10-01 11:00:00/p&#39;</span> app.log</span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">&#39;/ERROR/,+3&#39;</span> app.log</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="五、sed-vs-awk-vs-grep" tabindex="-1"><a class="header-anchor" href="#五、sed-vs-awk-vs-grep"><span>五、sed vs awk vs grep</span></a></h2><table><thead><tr><th style="text-align:left;">需求</th><th style="text-align:left;">推荐工具</th><th style="text-align:left;">示例</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">简单查找</td><td style="text-align:left;">grep</td><td style="text-align:left;"><code>grep &quot;error&quot; log</code></td><td style="text-align:left;">最快最简</td></tr><tr><td style="text-align:left;">文本替换</td><td style="text-align:left;">sed</td><td style="text-align:left;"><code>sed &#39;s/old/new/g&#39; file</code></td><td style="text-align:left;">行内编辑</td></tr><tr><td style="text-align:left;">列操作</td><td style="text-align:left;">awk</td><td style="text-align:left;"><code>awk &#39;{print $1,$3}&#39; file</code></td><td style="text-align:left;">字段处理</td></tr><tr><td style="text-align:left;">复杂计算</td><td style="text-align:left;">awk</td><td style="text-align:left;"><code>awk &#39;{sum+=$1} END{print sum}&#39;</code></td><td style="text-align:left;">统计功能</td></tr><tr><td style="text-align:left;">多文件处理</td><td style="text-align:left;">grep</td><td style="text-align:left;"><code>grep -r &quot;pattern&quot; dir/</code></td><td style="text-align:left;">递归搜索</td></tr><tr><td style="text-align:left;">结构化数据</td><td style="text-align:left;">awk</td><td style="text-align:left;"><code>awk -F, &#39;{print $2}&#39; csv</code></td><td style="text-align:left;">分隔符处理</td></tr></tbody></table>`,40)])])}const c=n(t,[["render",i]]),r=JSON.parse('{"path":"/02-Linux%E8%BF%9B%E9%98%B6/03-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/sed%E7%AC%94%E8%AE%B0.html","title":"关于 Linux 三剑客","lang":"zh-CN","frontmatter":{},"git":{"contributors":[{"name":"opsjjq","username":"opsjjq","email":"wangyp987@gmail.com","commits":1,"url":"https://github.com/opsjjq"}],"changelog":[{"hash":"ca8e661b7c6729c958583ed3d1a001b6de398273","time":1771558748000,"email":"wangyp987@gmail.com","author":"opsjjq","message":"222"}]},"filePathRelative":"02-Linux进阶/03-文本处理工具/sed笔记.md"}');export{c as comp,r as data};
