import{_ as n,c as a,e,o as t}from"./app-DtXLoKBz.js";const l={};function i(p,s){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="linux-三剑客-awk-文本处理" tabindex="-1"><a class="header-anchor" href="#linux-三剑客-awk-文本处理"><span>Linux 三剑客 - AWK 文本处理</span></a></h2><hr><h2 id="一、工具对比" tabindex="-1"><a class="header-anchor" href="#一、工具对比"><span>一、工具对比</span></a></h2><table><thead><tr><th style="text-align:left;">工具</th><th style="text-align:left;">擅长领域</th><th style="text-align:left;">特点</th><th style="text-align:left;">典型场景</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>grep</strong></td><td style="text-align:left;">查找匹配</td><td style="text-align:left;">快速过滤，正则匹配</td><td style="text-align:left;"><code>grep &quot;error&quot; logfile</code></td></tr><tr><td style="text-align:left;"><strong>sed</strong></td><td style="text-align:left;">编辑修改</td><td style="text-align:left;">流编辑，非交互式</td><td style="text-align:left;"><code>sed &#39;s/old/new/g&#39; file</code></td></tr><tr><td style="text-align:left;"><strong>awk</strong></td><td style="text-align:left;">格式化处理</td><td style="text-align:left;">字段处理，编程特性</td><td style="text-align:left;"><code>awk &#39;{print $1,$3}&#39; file</code></td></tr></tbody></table><hr><h2 id="二、awk-核心概念" tabindex="-1"><a class="header-anchor" href="#二、awk-核心概念"><span>二、AWK 核心概念</span></a></h2><h3 id="_1-awk-是什么" tabindex="-1"><a class="header-anchor" href="#_1-awk-是什么"><span>1. AWK 是什么？</span></a></h3><p>AWK 是一种<strong>文本处理编程语言</strong>，专为在 UNIX/Linux 环境下对文本数据进行处理而设计。</p><table><thead><tr><th style="text-align:left;">功能</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">扫描</td><td style="text-align:left;">逐行读取文本数据</td></tr><tr><td style="text-align:left;">过滤</td><td style="text-align:left;">基于条件筛选数据行</td></tr><tr><td style="text-align:left;">提取</td><td style="text-align:left;">按字段获取特定数据</td></tr><tr><td style="text-align:left;">格式化</td><td style="text-align:left;">按需求重新组织输出</td></tr><tr><td style="text-align:left;">计算</td><td style="text-align:left;">执行统计和数学运算</td></tr></tbody></table><h3 id="_2-基础语法" tabindex="-1"><a class="header-anchor" href="#_2-基础语法"><span>2. 基础语法</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token punctuation">[</span>选项<span class="token punctuation">]</span> <span class="token string">&#39;模式 {动作}&#39;</span> 文件/数据流  <span class="token comment"># 命令行模式</span></span>
<span class="line"><span class="token function">awk</span> <span class="token punctuation">[</span>选项<span class="token punctuation">]</span> <span class="token parameter variable">-f</span> 脚本文件 文件           <span class="token comment"># 脚本模式</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><code>-F fs</code></td><td style="text-align:left;">指定输入字段分隔符（默认：空格/制表符）</td></tr><tr><td style="text-align:left;"><code>-v var=值</code></td><td style="text-align:left;">定义变量并赋值</td></tr><tr><td style="text-align:left;"><code>-f 文件</code></td><td style="text-align:left;">从文件读取 awk 脚本</td></tr></tbody></table><hr><h2 id="三、awk-处理流程" tabindex="-1"><a class="header-anchor" href="#三、awk-处理流程"><span>三、AWK 处理流程</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">输入数据 → BEGIN块 → 主循环(逐行处理) → END块 → 输出结果</span>
<span class="line">        ↓          ↓                 ↓         ↓</span>
<span class="line">    初始化   匹配模式执行动作       最终处理</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="四、核心功能详解" tabindex="-1"><a class="header-anchor" href="#四、核心功能详解"><span>四、核心功能详解</span></a></h2><h3 id="_1-数据字段提取" tabindex="-1"><a class="header-anchor" href="#_1-数据字段提取"><span>1. 数据字段提取</span></a></h3><p><strong>默认分隔符（空格/制表符）：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span> test.log           <span class="token comment"># 提取第一列</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print $1,$3}&#39;</span> test.log       <span class="token comment"># 提取第一列和第三列</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print $(NF-1), $NF}&#39;</span> test.log  <span class="token comment"># 提取倒数两列</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定分隔符：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&#39;:&#39;</span> <span class="token string">&#39;{print &quot;用户名:&quot;, $1, &quot;UID:&quot;, $3}&#39;</span> /etc/passwd</span>
<span class="line"><span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&#39;[:|]&#39;</span> <span class="token string">&#39;{print $1, $2}&#39;</span> file.txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-内置变量" tabindex="-1"><a class="header-anchor" href="#_2-内置变量"><span>2. 内置变量</span></a></h3><h4 id="行相关变量" tabindex="-1"><a class="header-anchor" href="#行相关变量"><span>行相关变量</span></a></h4><table><thead><tr><th style="text-align:left;">变量</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><code>NR</code></td><td style="text-align:left;">当前行号（Number of Record）</td></tr><tr><td style="text-align:left;"><code>FNR</code></td><td style="text-align:left;">当前文件中的行号（File Number of Record）</td></tr></tbody></table><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print NR, $0}&#39;</span> file.txt              <span class="token comment"># 行号在前</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print $0, &quot;行号:&quot;, NR}&#39;</span> file.txt     <span class="token comment"># 行号在后</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;NR==5{print $0}&#39;</span> file.txt             <span class="token comment"># 仅第 5 行</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;NR&gt;=10 &amp;&amp; NR&lt;=20{print $0}&#39;</span> file.txt  <span class="token comment"># 10-20 行</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;NR%2==0{print $0}&#39;</span> file.txt           <span class="token comment"># 偶数行</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="列相关变量" tabindex="-1"><a class="header-anchor" href="#列相关变量"><span>列相关变量</span></a></h4><table><thead><tr><th style="text-align:left;">变量</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><code>NF</code></td><td style="text-align:left;">当前行的字段数（Number of Field）</td></tr><tr><td style="text-align:left;"><code>$0</code></td><td style="text-align:left;">整行内容</td></tr><tr><td style="text-align:left;"><code>$1,$2,...$NF</code></td><td style="text-align:left;">第 1,2,... 最后一个字段</td></tr></tbody></table><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print &quot;本行有&quot;, NF, &quot;列&quot;}&#39;</span> file.txt</span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print &quot;第一列:&quot;, $1, &quot;最后一列:&quot;, $NF}&#39;</span> file.txt</span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print &quot;倒数第二列:&quot;, $(NF-1)}&#39;</span> file.txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="分隔符变量" tabindex="-1"><a class="header-anchor" href="#分隔符变量"><span>分隔符变量</span></a></h4><table><thead><tr><th style="text-align:left;">变量</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><code>FS</code></td><td style="text-align:left;">输入字段分隔符（默认空格）</td></tr><tr><td style="text-align:left;"><code>RS</code></td><td style="text-align:left;">输入记录（行）分隔符（默认换行符）</td></tr><tr><td style="text-align:left;"><code>OFS</code></td><td style="text-align:left;">输出字段分隔符（默认空格）</td></tr><tr><td style="text-align:left;"><code>ORS</code></td><td style="text-align:left;">输出记录（行）分隔符（默认换行符）</td></tr></tbody></table><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&quot;a:b:c&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">FS</span><span class="token operator">=</span><span class="token string">&#39;:&#39;</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">OFS</span><span class="token operator">=</span><span class="token string">&#39;|&#39;</span> <span class="token string">&#39;{print $1,$2,$3}&#39;</span>  <span class="token comment"># 输出: a|b|c</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&quot;姓名:张三;年龄:25;城市:北京&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">RS</span><span class="token operator">=</span><span class="token string">&#39;;&#39;</span> <span class="token string">&#39;{print $0}&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="五、模式匹配" tabindex="-1"><a class="header-anchor" href="#五、模式匹配"><span>五、模式匹配</span></a></h2><h3 id="_1-正则表达式匹配" tabindex="-1"><a class="header-anchor" href="#_1-正则表达式匹配"><span>1. 正则表达式匹配</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;/error/{print NR &quot;:&quot; $0}&#39;</span> logfile           <span class="token comment"># 包含 error 的行</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;/^[0-9]+/{print $0}&#39;</span> file.txt              <span class="token comment"># 以数字开头</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;/[Aa]pple/{print $0}&#39;</span> fruit.txt            <span class="token comment"># 包含 Apple 或 apple</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;!/error/{print $0}&#39;</span> logfile                <span class="token comment"># 不包含 error 的行</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-字段值匹配" tabindex="-1"><a class="header-anchor" href="#_2-字段值匹配"><span>2. 字段值匹配</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;$1==&quot;root&quot;{print $0}&#39;</span> /etc/passwd          <span class="token comment"># 第一列等于 root</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;$3&gt;1000{print $0}&#39;</span> /etc/passwd            <span class="token comment"># UID 大于 1000</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;$1==&quot;root&quot; &amp;&amp; $3==0{print $0}&#39;</span> /etc/passwd  <span class="token comment"># root 且 UID 为 0</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;$1==&quot;root&quot; || $1==&quot;admin&quot;{print $0}&#39;</span> file.txt  <span class="token comment"># root 或 admin</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-范围模式" tabindex="-1"><a class="header-anchor" href="#_3-范围模式"><span>3. 范围模式</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;NR&gt;=5 &amp;&amp; NR&lt;=10{print $0}&#39;</span> file.txt       <span class="token comment"># 5-10 行</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;/start/,/end/{print $0}&#39;</span> file.txt          <span class="token comment"># start 到 end 之间的行</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;NR==10,/error/{print $0}&#39;</span> logfile         <span class="token comment"># 第 10 行到包含 error 的行</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="六、begin-和-end-块" tabindex="-1"><a class="header-anchor" href="#六、begin-和-end-块"><span>六、BEGIN 和 END 块</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;BEGIN{</span>
<span class="line">    FS=&quot;:&quot;                                       # 设置输入分隔符</span>
<span class="line">    OFS=&quot;\\t&quot;                                     # 设置输出分隔符</span>
<span class="line">    count=0                                      # 初始化计数器</span>
<span class="line">    print &quot;用户\\tUID\\tGID&quot;                       # 打印表头</span>
<span class="line">}</span>
<span class="line">{</span>
<span class="line">    count++                                      # 统计行数</span>
<span class="line">    print $1,$3,$4                               # 处理每行数据</span>
<span class="line">}</span>
<span class="line">END{</span>
<span class="line">    print &quot;================&quot;</span>
<span class="line">    print &quot;总计用户数:&quot;, count</span>
<span class="line">    print &quot;处理完成!&quot;</span>
<span class="line">}&#39;</span> /etc/passwd</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="七、实战案例" tabindex="-1"><a class="header-anchor" href="#七、实战案例"><span>七、实战案例</span></a></h2><h3 id="案例-1-统计单词频率" tabindex="-1"><a class="header-anchor" href="#案例-1-统计单词频率"><span>案例 1：统计单词频率</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">RS</span><span class="token operator">=</span><span class="token string">&#39;[^a-zA-Z0-9]+&#39;</span> <span class="token string">&#39;{</span>
<span class="line">    word = tolower($0)</span>
<span class="line">    count[word]++</span>
<span class="line">}</span>
<span class="line">END{</span>
<span class="line">    for(w in count) print count[w], w</span>
<span class="line">}&#39;</span> article.txt <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-rn</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-5</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例-2-系统监控" tabindex="-1"><a class="header-anchor" href="#案例-2-系统监控"><span>案例 2：系统监控</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">top</span> <span class="token parameter variable">-bn1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;/^%Cpu/{print &quot;用户CPU:&quot;, $2, &quot;%&quot;, &quot;系统CPU:&quot;, $4, &quot;%&quot;}&#39;</span></span>
<span class="line"><span class="token function">free</span> <span class="token parameter variable">-m</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;/^Mem:/{print &quot;总内存:&quot;, $2, &quot;M&quot;, &quot;已使用:&quot;, $3, &quot;M&quot;, &quot;使用率:&quot;, $3/$2*100, &quot;%&quot;}&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例-3-日志分析" tabindex="-1"><a class="header-anchor" href="#案例-3-日志分析"><span>案例 3：日志分析</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> <span class="token string">&#39;{status_count[$9]++} END{for(code in status_count) print code, status_count[code]}&#39;</span> access.log</span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{ip_count[$1]++} END{for(ip in ip_count) if(ip_count[ip]&gt;100) print ip, ip_count[ip]}&#39;</span> access.log <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-rnk2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例-4-数据报表" tabindex="-1"><a class="header-anchor" href="#案例-4-数据报表"><span>案例 4：数据报表</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">awk</span> -F<span class="token string">&#39;,&#39;</span> <span class="token string">&#39;BEGIN{</span>
<span class="line">    print &quot;=== 销售报表 ===&quot;</span>
<span class="line">    printf &quot;%-10s %-8s %-10s %-10s\\n&quot;, &quot;产品&quot;, &quot;数量&quot;, &quot;单价&quot;, &quot;总价&quot;</span>
<span class="line">    total=0</span>
<span class="line">}</span>
<span class="line">{</span>
<span class="line">    product=$1</span>
<span class="line">    qty=$2</span>
<span class="line">    price=$3</span>
<span class="line">    subtotal=qty*price</span>
<span class="line">    total+=subtotal</span>
<span class="line">    printf &quot;%-10s %-8d %-10.2f %-10.2f\\n&quot;, product, qty, price, subtotal</span>
<span class="line">}</span>
<span class="line">END{</span>
<span class="line">    print &quot;=========================&quot;</span>
<span class="line">    printf &quot;总计: %.2f\\n&quot;, total</span>
<span class="line">}&#39;</span> sales.csv</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 原文内容</span></span>
<span class="line">I have a dog, it is lovely, it is called Mimi. Every <span class="token function">time</span> I go home<span class="token punctuation">..</span>.</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 统计前5个高频词</span></span>
<span class="line"><span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">RS</span><span class="token operator">=</span><span class="token string">&#39;[^a-zA-Z0-9]+&#39;</span> <span class="token string">&#39;{</span>
<span class="line">    word = tolower($0)      # 转小写</span>
<span class="line">    count[word]++           # 统计词频</span>
<span class="line">} </span>
<span class="line">END{</span>
<span class="line">    for(w in count){</span>
<span class="line">        print count[w], w   # 输出 频率 单词</span>
<span class="line">    }</span>
<span class="line">}&#39;</span> article.txt <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-rn</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-5</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 更简洁版本</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{for(i=1;i&lt;=NF;i++) words[tolower($i)]++} END{for(w in words) print words[w],w}&#39;</span> article.txt <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-rn</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-5</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="案例2-系统监控" tabindex="-1"><a class="header-anchor" href="#案例2-系统监控"><span>案例2：系统监控</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 监控CPU使用率（top命令输出）</span></span>
<span class="line"><span class="token function">top</span> <span class="token parameter variable">-bn1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;/^%Cpu/{print &quot;用户CPU:&quot;, $2, &quot;%&quot;, &quot;系统CPU:&quot;, $4, &quot;%&quot;}&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 监控内存使用</span></span>
<span class="line"><span class="token function">free</span> <span class="token parameter variable">-m</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;/^Mem:/{print &quot;总内存:&quot;, $2, &quot;M&quot;, &quot;已使用:&quot;, $3, &quot;M&quot;, &quot;使用率:&quot;, $3/$2*100, &quot;%&quot;}&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="案例3-日志分析" tabindex="-1"><a class="header-anchor" href="#案例3-日志分析"><span>案例3：日志分析</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 统计HTTP状态码</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{status_count[$9]++} END{for(code in status_count) print code, status_count[code]}&#39;</span> access.log</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 统计IP访问量</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{ip_count[$1]++} END{for(ip in ip_count) if(ip_count[ip]&gt;100) print ip, ip_count[ip]}&#39;</span> access.log <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-rnk2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="案例4-数据报表" tabindex="-1"><a class="header-anchor" href="#案例4-数据报表"><span>案例4：数据报表</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 生成销售报表</span></span>
<span class="line"><span class="token function">awk</span> -F<span class="token string">&#39;,&#39;</span> <span class="token string">&#39;BEGIN{</span>
<span class="line">    print &quot;=== 销售报表 ===&quot;</span>
<span class="line">    printf &quot;%-10s %-8s %-10s %-10s\\n&quot;, &quot;产品&quot;, &quot;数量&quot;, &quot;单价&quot;, &quot;总价&quot;</span>
<span class="line">    total=0</span>
<span class="line">}</span>
<span class="line">{</span>
<span class="line">    product=$1</span>
<span class="line">    qty=$2</span>
<span class="line">    price=$3</span>
<span class="line">    subtotal=qty*price</span>
<span class="line">    total+=subtotal</span>
<span class="line">    printf &quot;%-10s %-8d %-10.2f %-10.2f\\n&quot;, product, qty, price, subtotal</span>
<span class="line">}</span>
<span class="line">END{</span>
<span class="line">    print &quot;=========================&quot;</span>
<span class="line">    printf &quot;总计: %.2f\\n&quot;, total</span>
<span class="line">}&#39;</span> sales.csv</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,60)])])}const r=n(l,[["render",i]]),o=JSON.parse('{"path":"/02-Linux%E8%BF%9B%E9%98%B6/03-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/awk%E7%AC%94%E8%AE%B0.html","title":"AWK笔记","lang":"zh-CN","frontmatter":{"title":"AWK笔记"},"git":{"contributors":[{"name":"opsjjq","username":"opsjjq","email":"wangyp987@gmail.com","commits":1,"url":"https://github.com/opsjjq"}],"changelog":[{"hash":"ca8e661b7c6729c958583ed3d1a001b6de398273","time":1771558748000,"email":"wangyp987@gmail.com","author":"opsjjq","message":"222"}]},"filePathRelative":"02-Linux进阶/03-文本处理工具/awk笔记.md"}');export{r as comp,o as data};
