import{_ as n,c as a,e,o as l}from"./app-DtXLoKBz.js";const p={};function t(i,s){return l(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="kubernetes-网络与服务-service-汇总" tabindex="-1"><a class="header-anchor" href="#kubernetes-网络与服务-service-汇总"><span>Kubernetes 网络与服务（Service）汇总</span></a></h1><h2 id="_1-kubernetes-网络基础" tabindex="-1"><a class="header-anchor" href="#_1-kubernetes-网络基础"><span>1. Kubernetes 网络基础</span></a></h2><h3 id="网络模型要求" tabindex="-1"><a class="header-anchor" href="#网络模型要求"><span>网络模型要求</span></a></h3><p>Kubernetes 对网络有以下基本要求：</p><ol><li>所有 Pod 不经过 NAT 就能相互通信</li><li>所有 Node 都能与所有 Pod 通信</li><li>Pod 看到的自己 IP 与其他 Pod 看到的相同</li></ol><hr><h3 id="pod-网络特性" tabindex="-1"><a class="header-anchor" href="#pod-网络特性"><span>Pod 网络特性</span></a></h3><ul><li><strong>Pod IP 不稳定</strong>：Pod 重建后 IP 会变化</li><li><strong>同一 Pod 内容器共享网络</strong>：通过 <code>localhost</code> 通信</li><li><strong>跨节点 Pod 直连</strong>：通过 CNI 网络插件实现</li></ul><hr><h2 id="_2-service-概述" tabindex="-1"><a class="header-anchor" href="#_2-service-概述"><span>2. Service 概述</span></a></h2><h3 id="什么是-service" tabindex="-1"><a class="header-anchor" href="#什么是-service"><span>什么是 Service</span></a></h3><p>Service 是 Kubernetes 中定义的一种抽象，它定义了一组 Pod 的逻辑集合和访问这些 Pod 的策略。</p><hr><h3 id="service-的作用" tabindex="-1"><a class="header-anchor" href="#service-的作用"><span>Service 的作用</span></a></h3><ol><li><strong>服务发现</strong>：为 Pod 提供稳定的访问入口</li><li><strong>负载均衡</strong>：在多个 Pod 之间分发流量</li><li><strong>跨节点访问</strong>：允许从集群外部访问应用</li></ol><hr><h3 id="service-类型" tabindex="-1"><a class="header-anchor" href="#service-类型"><span>Service 类型</span></a></h3><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>ClusterIP</strong></td><td style="text-align:left;">集群内部访问（默认）</td></tr><tr><td style="text-align:left;"><strong>NodePort</strong></td><td style="text-align:left;">通过节点端口访问</td></tr><tr><td style="text-align:left;"><strong>LoadBalancer</strong></td><td style="text-align:left;">云厂商负载均衡器</td></tr><tr><td style="text-align:left;"><strong>ExternalName</strong></td><td style="text-align:left;">DNS 别名映射</td></tr></tbody></table><hr><h2 id="_3-clusterip-service" tabindex="-1"><a class="header-anchor" href="#_3-clusterip-service"><span>3. ClusterIP Service</span></a></h2><h3 id="基本概念" tabindex="-1"><a class="header-anchor" href="#基本概念"><span>基本概念</span></a></h3><p>ClusterIP 是默认的 Service 类型，提供一个集群内部的虚拟 IP（VIP），只能在集群内部访问。</p><hr><h3 id="创建-clusterip-service" tabindex="-1"><a class="header-anchor" href="#创建-clusterip-service"><span>创建 ClusterIP Service</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http</span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP</span>
<span class="line">  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建 Service</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> svc-clusterip.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Service</span></span>
<span class="line">kubectl get svc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Service 详情</span></span>
<span class="line">kubectl describe svc nginx</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Endpoints（后端 Pod）</span></span>
<span class="line">kubectl get endpoints nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="访问-clusterip-service" tabindex="-1"><a class="header-anchor" href="#访问-clusterip-service"><span>访问 ClusterIP Service</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 获取 Service IP</span></span>
<span class="line">kubectl get svc nginx</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 在集群内访问</span></span>
<span class="line"><span class="token function">curl</span> <span class="token operator">&lt;</span>cluster-ip<span class="token operator">&gt;</span>:80</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 在 Pod 内访问</span></span>
<span class="line">kubectl run test-pod <span class="token parameter variable">--image</span><span class="token operator">=</span>busybox <span class="token parameter variable">--rm</span> <span class="token parameter variable">-it</span> -- <span class="token function">sh</span></span>
<span class="line"><span class="token comment"># 在 Pod 内执行：wget -O- nginx:80</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_4-nodeport-service" tabindex="-1"><a class="header-anchor" href="#_4-nodeport-service"><span>4. NodePort Service</span></a></h2><h3 id="基本概念-1" tabindex="-1"><a class="header-anchor" href="#基本概念-1"><span>基本概念</span></a></h3><p>NodePort 通过每个 Node 的 IP 和静态端口暴露服务，可以从集群外部访问。</p><hr><h3 id="创建-nodeport-service" tabindex="-1"><a class="header-anchor" href="#创建-nodeport-service"><span>创建 NodePort Service</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>nodeport</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http</span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">30080</span>  <span class="token comment"># 30000-32767 范围内</span></span>
<span class="line">      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP</span>
<span class="line">  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建 Service</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> svc-nodeport.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Service</span></span>
<span class="line">kubectl get svc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 从外部访问</span></span>
<span class="line"><span class="token function">curl</span> <span class="token operator">&lt;</span>node-ip<span class="token operator">&gt;</span>:30080</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="nodeport-端口范围" tabindex="-1"><a class="header-anchor" href="#nodeport-端口范围"><span>NodePort 端口范围</span></a></h3><p>默认端口范围：<code>30000-32767</code></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 修改端口范围（在 kube-apiserver 配置中）</span></span>
<span class="line"><span class="token comment"># --service-node-port-range=1-65535</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_5-loadbalancer-service" tabindex="-1"><a class="header-anchor" href="#_5-loadbalancer-service"><span>5. LoadBalancer Service</span></a></h2><h3 id="基本概念-2" tabindex="-1"><a class="header-anchor" href="#基本概念-2"><span>基本概念</span></a></h3><p>LoadBalancer 类型的 Service 会向云厂商（如 AWS、阿里云）申请一个外部负载均衡器，将流量转发到 NodePort。</p><hr><h3 id="创建-loadbalancer-service" tabindex="-1"><a class="header-anchor" href="#创建-loadbalancer-service"><span>创建 LoadBalancer Service</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>lb</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http</span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP</span>
<span class="line">  <span class="token key atrule">type</span><span class="token punctuation">:</span> LoadBalancer</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建 Service（需要云厂商支持）</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> svc-loadbalancer.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Service</span></span>
<span class="line">kubectl get svc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 访问外部负载均衡器 IP</span></span>
<span class="line"><span class="token function">curl</span> <span class="token operator">&lt;</span>external-ip<span class="token operator">&gt;</span>:80</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_6-externalname-service" tabindex="-1"><a class="header-anchor" href="#_6-externalname-service"><span>6. ExternalName Service</span></a></h2><h3 id="基本概念-3" tabindex="-1"><a class="header-anchor" href="#基本概念-3"><span>基本概念</span></a></h3><p>ExternalName 将 Service 映射到外部 DNS 名称，不创建代理或负载均衡器。</p><hr><h3 id="创建-externalname-service" tabindex="-1"><a class="header-anchor" href="#创建-externalname-service"><span>创建 ExternalName Service</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>service</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">type</span><span class="token punctuation">:</span> ExternalName</span>
<span class="line">  <span class="token key atrule">externalName</span><span class="token punctuation">:</span> my.database.example.com</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建 Service</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> svc-externalname.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查询 DNS</span></span>
<span class="line"><span class="token function">nslookup</span> my-service.default.svc.cluster.local</span>
<span class="line"><span class="token comment"># 返回：my.database.example.com</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_7-service-与-pod-的关系" tabindex="-1"><a class="header-anchor" href="#_7-service-与-pod-的关系"><span>7. Service 与 Pod 的关系</span></a></h2><h3 id="标签选择器" tabindex="-1"><a class="header-anchor" href="#标签选择器"><span>标签选择器</span></a></h3><p>Service 通过 <code>selector</code> 字段选择 Pod：</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx  <span class="token comment"># 选择带有 app=nginx 标签的 Pod</span></span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="endpoints" tabindex="-1"><a class="header-anchor" href="#endpoints"><span>Endpoints</span></a></h3><p>Service 自动维护后端 Pod 的 IP 列表：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 查看 Endpoints</span></span>
<span class="line">kubectl get endpoints nginx</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Endpoints 详情</span></span>
<span class="line">kubectl describe endpoints nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="无-selector-的-service" tabindex="-1"><a class="header-anchor" href="#无-selector-的-service"><span>无 Selector 的 Service</span></a></h3><p>当 Service 没有 selector 时，需要手动创建 Endpoints：</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> external<span class="token punctuation">-</span>service</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">---</span></span>
<span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Endpoints</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> external<span class="token punctuation">-</span>service</span>
<span class="line"><span class="token key atrule">subsets</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> <span class="token key atrule">addresses</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">ip</span><span class="token punctuation">:</span> 10.0.0.100</span>
<span class="line">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_8-service-会话保持" tabindex="-1"><a class="header-anchor" href="#_8-service-会话保持"><span>8. Service 会话保持</span></a></h2><h3 id="会话亲和性" tabindex="-1"><a class="header-anchor" href="#会话亲和性"><span>会话亲和性</span></a></h3><p>通过 <code>sessionAffinity</code> 配置会话保持：</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>sticky</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">  <span class="token key atrule">sessionAffinity</span><span class="token punctuation">:</span> ClientIP</span>
<span class="line">  <span class="token key atrule">sessionAffinityConfig</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">clientIP</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">timeoutSeconds</span><span class="token punctuation">:</span> <span class="token number">10800</span>  <span class="token comment"># 3小时</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="会话保持类型" tabindex="-1"><a class="header-anchor" href="#会话保持类型"><span>会话保持类型</span></a></h3><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>None</strong></td><td style="text-align:left;">无会话保持（默认）</td></tr><tr><td style="text-align:left;"><strong>ClientIP</strong></td><td style="text-align:left;">基于客户端 IP 的会话保持</td></tr></tbody></table><hr><h2 id="_9-service-dns" tabindex="-1"><a class="header-anchor" href="#_9-service-dns"><span>9. Service DNS</span></a></h2><h3 id="coredns" tabindex="-1"><a class="header-anchor" href="#coredns"><span>CoreDNS</span></a></h3><p>Kubernetes 集群默认运行 CoreDNS，为 Service 提供 DNS 解析。</p><hr><h3 id="dns-解析格式" tabindex="-1"><a class="header-anchor" href="#dns-解析格式"><span>DNS 解析格式</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Service 完整域名格式</span></span>
<span class="line"><span class="token operator">&lt;</span>service-name<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>namespace<span class="token operator">&gt;</span>.svc.cluster.local</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 示例</span></span>
<span class="line">nginx.default.svc.cluster.local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="dns-解析测试" tabindex="-1"><a class="header-anchor" href="#dns-解析测试"><span>DNS 解析测试</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 在 Pod 内测试 DNS</span></span>
<span class="line">kubectl run dns-test <span class="token parameter variable">--image</span><span class="token operator">=</span>busybox <span class="token parameter variable">--rm</span> <span class="token parameter variable">-it</span> -- <span class="token function">sh</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 在 Pod 内执行</span></span>
<span class="line"><span class="token function">nslookup</span> nginx</span>
<span class="line"><span class="token function">nslookup</span> nginx.default</span>
<span class="line"><span class="token function">nslookup</span> nginx.default.svc.cluster.local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_10-headless-service" tabindex="-1"><a class="header-anchor" href="#_10-headless-service"><span>10. Headless Service</span></a></h2><h3 id="基本概念-4" tabindex="-1"><a class="header-anchor" href="#基本概念-4"><span>基本概念</span></a></h3><p>Headless Service 不分配 ClusterIP，而是直接返回 Pod IP 列表，用于需要直接访问 Pod 的场景。</p><hr><h3 id="创建-headless-service" tabindex="-1"><a class="header-anchor" href="#创建-headless-service"><span>创建 Headless Service</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>headless</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">clusterIP</span><span class="token punctuation">:</span> None  <span class="token comment"># 关键：设置为 None</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建 Service</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> svc-headless.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Service（ClusterIP 为 None）</span></span>
<span class="line">kubectl get svc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># DNS 解析返回所有 Pod IP</span></span>
<span class="line"><span class="token function">nslookup</span> nginx-headless.default.svc.cluster.local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_11-service-与-ingress" tabindex="-1"><a class="header-anchor" href="#_11-service-与-ingress"><span>11. Service 与 Ingress</span></a></h2><h3 id="service-vs-ingress" tabindex="-1"><a class="header-anchor" href="#service-vs-ingress"><span>Service vs Ingress</span></a></h3><table><thead><tr><th style="text-align:left;">特性</th><th style="text-align:left;">Service</th><th style="text-align:left;">Ingress</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>作用层级</strong></td><td style="text-align:left;">L4（TCP/UDP）</td><td style="text-align:left;">L7（HTTP/HTTPS）</td></tr><tr><td style="text-align:left;"><strong>路由规则</strong></td><td style="text-align:left;">简单的端口映射</td><td style="text-align:left;">基于主机名、路径的路由</td></tr><tr><td style="text-align:left;"><strong>SSL/TLS</strong></td><td style="text-align:left;">不支持</td><td style="text-align:left;">支持</td></tr><tr><td style="text-align:left;"><strong>适用场景</strong></td><td style="text-align:left;">内部服务、数据库</td><td style="text-align:left;">Web 应用、API</td></tr></tbody></table><hr><h3 id="ingress-示例" tabindex="-1"><a class="header-anchor" href="#ingress-示例"><span>Ingress 示例</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">rules</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> www.example.com</span>
<span class="line">      <span class="token key atrule">http</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">paths</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /</span>
<span class="line">            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix</span>
<span class="line">            <span class="token key atrule">backend</span><span class="token punctuation">:</span></span>
<span class="line">              <span class="token key atrule">service</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">                <span class="token key atrule">port</span><span class="token punctuation">:</span></span>
<span class="line">                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_12-service-最佳实践" tabindex="-1"><a class="header-anchor" href="#_12-service-最佳实践"><span>12. Service 最佳实践</span></a></h2><h3 id="命名规范" tabindex="-1"><a class="header-anchor" href="#命名规范"><span>命名规范</span></a></h3><ul><li>Service 名称：小写字母、数字、连字符</li><li>避免使用保留字：<code>kubernetes</code>、<code>kube-</code> 开头的名称</li></ul><hr><h3 id="端口命名" tabindex="-1"><a class="header-anchor" href="#端口命名"><span>端口命名</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http    <span class="token comment"># 建议命名端口</span></span>
<span class="line">      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> https</span>
<span class="line">      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">443</span></span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">443</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="资源限制" tabindex="-1"><a class="header-anchor" href="#资源限制"><span>资源限制</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">  <span class="token key atrule">sessionAffinity</span><span class="token punctuation">:</span> ClientIP</span>
<span class="line">  <span class="token key atrule">sessionAffinityConfig</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">clientIP</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">timeoutSeconds</span><span class="token punctuation">:</span> <span class="token number">10800</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_13-常用命令汇总" tabindex="-1"><a class="header-anchor" href="#_13-常用命令汇总"><span>13. 常用命令汇总</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建 Service</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> svc.yaml</span>
<span class="line">kubectl expose deployment nginx <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">80</span> --target-port<span class="token operator">=</span><span class="token number">80</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Service</span></span>
<span class="line">kubectl get svc</span>
<span class="line">kubectl get svc <span class="token parameter variable">-o</span> wide</span>
<span class="line">kubectl describe svc <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Endpoints</span></span>
<span class="line">kubectl get endpoints</span>
<span class="line">kubectl describe endpoints <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 删除 Service</span></span>
<span class="line">kubectl delete svc <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span></span>
<span class="line">kubectl delete <span class="token parameter variable">-f</span> svc.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 编辑 Service</span></span>
<span class="line">kubectl edit svc <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 导出 Service 配置</span></span>
<span class="line">kubectl get svc <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token parameter variable">-o</span> yaml <span class="token operator">&gt;</span> svc-config.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_14-故障排查" tabindex="-1"><a class="header-anchor" href="#_14-故障排查"><span>14. 故障排查</span></a></h2><h3 id="service-无法访问" tabindex="-1"><a class="header-anchor" href="#service-无法访问"><span>Service 无法访问</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. 检查 Service 是否存在</span></span>
<span class="line">kubectl get svc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. 检查 Endpoints 是否有后端 Pod</span></span>
<span class="line">kubectl get endpoints <span class="token operator">&lt;</span>svc-name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. 检查 Pod 是否正常运行</span></span>
<span class="line">kubectl get pods <span class="token parameter variable">-l</span> <span class="token operator">&lt;</span>label-selector<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. 检查 Pod 标签是否匹配</span></span>
<span class="line">kubectl get pods --show-labels</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 5. 检查 Pod 是否就绪</span></span>
<span class="line">kubectl describe pod <span class="token operator">&lt;</span>pod-name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 6. 在 Pod 内测试连接</span></span>
<span class="line">kubectl run test-pod <span class="token parameter variable">--image</span><span class="token operator">=</span>busybox <span class="token parameter variable">--rm</span> <span class="token parameter variable">-it</span> -- <span class="token function">sh</span></span>
<span class="line"><span class="token comment"># 在 Pod 内执行：wget -O- &lt;service-name&gt;:&lt;port&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="dns-解析失败" tabindex="-1"><a class="header-anchor" href="#dns-解析失败"><span>DNS 解析失败</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. 检查 CoreDNS Pod 是否运行</span></span>
<span class="line">kubectl get pods <span class="token parameter variable">-n</span> kube-system <span class="token parameter variable">-l</span> k8s-app<span class="token operator">=</span>kube-dns</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. 查看 CoreDNS 日志</span></span>
<span class="line">kubectl logs <span class="token parameter variable">-n</span> kube-system <span class="token parameter variable">-l</span> k8s-app<span class="token operator">=</span>kube-dns</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. 测试 DNS 解析</span></span>
<span class="line">kubectl run dns-test <span class="token parameter variable">--image</span><span class="token operator">=</span>busybox <span class="token parameter variable">--rm</span> <span class="token parameter variable">-it</span> -- <span class="token function">nslookup</span> kubernetes.default</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_15-总结" tabindex="-1"><a class="header-anchor" href="#_15-总结"><span>15. 总结</span></a></h2><h3 id="service-关键要点" tabindex="-1"><a class="header-anchor" href="#service-关键要点"><span>Service 关键要点</span></a></h3><ol><li><strong>Service 提供稳定的访问入口</strong>，解决 Pod IP 不稳定的问题</li><li><strong>ClusterIP</strong> 用于集群内部访问</li><li><strong>NodePort</strong> 用于外部访问</li><li><strong>LoadBalancer</strong> 用于云厂商负载均衡</li><li><strong>Headless Service</strong> 用于直接访问 Pod</li><li><strong>CoreDNS</strong> 提供 Service 的 DNS 解析</li><li><strong>Ingress</strong> 提供 L7 层的路由能力</li></ol><hr><h3 id="选择-service-类型" tabindex="-1"><a class="header-anchor" href="#选择-service-类型"><span>选择 Service 类型</span></a></h3><table><thead><tr><th style="text-align:left;">场景</th><th style="text-align:left;">推荐类型</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>集群内部服务</strong></td><td style="text-align:left;">ClusterIP</td></tr><tr><td style="text-align:left;"><strong>外部访问应用</strong></td><td style="text-align:left;">NodePort 或 LoadBalancer</td></tr><tr><td style="text-align:left;"><strong>有状态应用</strong></td><td style="text-align:left;">Headless Service</td></tr><tr><td style="text-align:left;"><strong>Web 应用路由</strong></td><td style="text-align:left;">Ingress + Service</td></tr><tr><td style="text-align:left;"><strong>外部服务映射</strong></td><td style="text-align:left;">ExternalName</td></tr></tbody></table>`,130)])])}const r=n(p,[["render",t]]),o=JSON.parse('{"path":"/05-%E5%AE%B9%E5%99%A8%E7%BC%96%E6%8E%92/03-kubernetes%E7%BC%96%E6%8E%92/5-k8s%E7%BD%91%E7%BB%9Cservice.html","title":"Kubernetes 网络与服务（Service）汇总","lang":"zh-CN","frontmatter":{},"git":{"contributors":[{"name":"opsjjq","username":"opsjjq","email":"wangyp987@gmail.com","commits":1,"url":"https://github.com/opsjjq"}],"changelog":[{"hash":"ca8e661b7c6729c958583ed3d1a001b6de398273","time":1771558748000,"email":"wangyp987@gmail.com","author":"opsjjq","message":"222"}]},"filePathRelative":"05-容器编排/03-kubernetes编排/5-k8s网络service.md"}');export{r as comp,o as data};
