import{_ as s,c as a,e,o as l}from"./app-DtXLoKBz.js";const p={};function t(i,n){return l(),a("div",null,[...n[0]||(n[0]=[e(`<h1 id="kubernetes-pod-资源汇总" tabindex="-1"><a class="header-anchor" href="#kubernetes-pod-资源汇总"><span>Kubernetes Pod 资源汇总</span></a></h1><h2 id="_1-pod-是什么" tabindex="-1"><a class="header-anchor" href="#_1-pod-是什么"><span>1. Pod 是什么</span></a></h2><p>Pod 是 Kubernetes 中最小的<strong>调度与运行单元</strong>，属于资源对象。它是一组共享命名空间（网络、IPC 等）的容器集合，是 Kubernetes 进行资源调度的最小单位。</p><hr><h2 id="_2-创建-pod" tabindex="-1"><a class="header-anchor" href="#_2-创建-pod"><span>2. 创建 Pod</span></a></h2><h3 id="组件创建-pod-流程" tabindex="-1"><a class="header-anchor" href="#组件创建-pod-流程"><span>组件创建 Pod 流程</span></a></h3><ol><li>客户端准备 Pod 的 YAML 声明式配置文件</li><li>kubectl 通过 HTTP 向 kube-apiserver 发送创建 Pod 请求</li><li>kube-apiserver 对请求进行认证、授权和准入控制</li><li>kube-apiserver 将 Pod 对象写入 etcd（状态为 Pending，<code>spec.nodeName</code> 为空）</li><li>kube-scheduler 通过 watch API Server，发现未调度的 Pod</li><li>kube-scheduler 通过 API Server 获取集群中 Pod/Node 等资源信息，完成调度决策</li><li>kube-scheduler 向 API Server 提交更新请求，为 Pod 写入 <code>spec.nodeName</code></li><li>kube-apiserver 将更新后的 Pod 信息写入 etcd，完成 Pod 与 Node 的绑定</li><li>目标 Node 上的 kubelet 通过 watch API Server，发现属于自己的 Pod</li><li>kubelet 调用容器运行时（CRI）创建 Pause 容器和业务容器，并持续上报 Pod 状态</li></ol><hr><h3 id="yaml-创建-pod" tabindex="-1"><a class="header-anchor" href="#yaml-创建-pod"><span>YAML 创建 Pod</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token comment"># pod-multi-container.yaml</span></span>
<span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> multi<span class="token punctuation">-</span>container<span class="token punctuation">-</span>pod</span>
<span class="line">  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default</span>
<span class="line">  <span class="token key atrule">labels</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> web<span class="token punctuation">-</span>app</span>
<span class="line">    <span class="token key atrule">tier</span><span class="token punctuation">:</span> frontend</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>container</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>container</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">5.7</span></span>
<span class="line">      <span class="token key atrule">env</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> MYSQL_ROOT_PASSWORD</span>
<span class="line">          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;123456&quot;</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> MYSQL_DATABASE</span>
<span class="line">          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;appdb&quot;</span></span>
<span class="line">      <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">3306</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建 Pod</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> pod-multi-container.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Pod 信息与标签</span></span>
<span class="line">kubectl get pods <span class="token parameter variable">-o</span> wide --show-labels</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 修改标签</span></span>
<span class="line">kubectl label pods multi-container-pod <span class="token assign-left variable">app</span><span class="token operator">=</span>nginx-mysql <span class="token parameter variable">--overwrite</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="删除-pod" tabindex="-1"><a class="header-anchor" href="#删除-pod"><span>删除 Pod</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 通过 YAML 文件删除</span></span>
<span class="line">kubectl delete <span class="token parameter variable">-f</span> pod-multi-container.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 直接删除 Pod</span></span>
<span class="line">kubectl delete pods multi-container-pod</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 按标签删除 Pod</span></span>
<span class="line">kubectl delete pods <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>web-app</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_3-pod-资源状态管理" tabindex="-1"><a class="header-anchor" href="#_3-pod-资源状态管理"><span>3. Pod 资源状态管理</span></a></h2><p>Pod 生命周期中的常见状态：</p><table><thead><tr><th style="text-align:left;">状态</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Pending</strong></td><td style="text-align:left;">已调度，正在拉取镜像或创建容器</td></tr><tr><td style="text-align:left;"><strong>Running</strong></td><td style="text-align:left;">所有容器正常运行</td></tr><tr><td style="text-align:left;"><strong>Succeeded</strong></td><td style="text-align:left;">所有容器成功退出（Job 类任务）</td></tr><tr><td style="text-align:left;"><strong>Failed</strong></td><td style="text-align:left;">至少一个容器异常退出</td></tr><tr><td style="text-align:left;"><strong>CrashLoopBackOff</strong></td><td style="text-align:left;">容器反复崩溃重启</td></tr></tbody></table><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 查看 Pod 状态</span></span>
<span class="line">kubectl get pods <span class="token parameter variable">-o</span> wide</span>
<span class="line">kubectl get pods <span class="token parameter variable">-o</span> wide --show-labels</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Pod 详情与事件</span></span>
<span class="line">kubectl describe pod <span class="token operator">&lt;</span>pod-name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看容器日志</span></span>
<span class="line">kubectl logs <span class="token operator">&lt;</span>pod-name<span class="token operator">&gt;</span> <span class="token punctuation">[</span>-c <span class="token operator">&lt;</span>container-name<span class="token operator">&gt;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 实时监测 Pod 变化</span></span>
<span class="line">kubectl get pods <span class="token parameter variable">-w</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_4-pod-详情信息查看" tabindex="-1"><a class="header-anchor" href="#_4-pod-详情信息查看"><span>4. Pod 详情信息查看</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl describe pods <span class="token operator">&lt;</span>pod-name<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>输出包含：</p><ul><li><strong>基本信息</strong>：名称、命名空间、标签、节点等</li><li><strong>容器状态</strong>：运行状态、重启次数、镜像等</li><li><strong>事件（Events）</strong>：从创建到当前的完整事件记录</li><li><strong>资源限制</strong>：CPU、内存的 requests 与 limits</li><li><strong>网络信息</strong>：IP 地址、端口映射等</li></ul><hr><h2 id="_5-pod-环境变量" tabindex="-1"><a class="header-anchor" href="#_5-pod-环境变量"><span>5. Pod 环境变量</span></a></h2><p>环境变量用于向容器传递配置信息。</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>with<span class="token punctuation">-</span>env</span>
<span class="line">  <span class="token key atrule">labels</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">app</span><span class="token punctuation">:</span> mysql</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">5.7</span></span>
<span class="line">      <span class="token key atrule">env</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> MYSQL_ROOT_PASSWORD</span>
<span class="line">          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;123456&quot;</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> MYSQL_DATABASE</span>
<span class="line">          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;appdb&quot;</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> APP_ENV</span>
<span class="line">          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;production&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="查看-pod-内环境变量" tabindex="-1"><a class="header-anchor" href="#查看-pod-内环境变量"><span>查看 Pod 内环境变量</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. 创建 Pod</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> mysql-pod.yaml</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. 进入容器查看环境变量</span></span>
<span class="line">kubectl <span class="token builtin class-name">exec</span> mysql-with-env -- <span class="token function">env</span> <span class="token operator">|</span> <span class="token function">grep</span> MYSQL</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. 通过 describe 查看环境变量配置</span></span>
<span class="line">kubectl describe pods mysql-with-env</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. 导出为 YAML 查看</span></span>
<span class="line">kubectl get pods mysql-with-env <span class="token parameter variable">-o</span> yaml <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-A5</span> env:</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_6-容器启动命令" tabindex="-1"><a class="header-anchor" href="#_6-容器启动命令"><span>6. 容器启动命令</span></a></h2><p>通过 <code>command</code> 字段覆盖容器默认的启动命令。</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> busybox<span class="token punctuation">-</span>once</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> Never  <span class="token comment"># 执行一次后不重启</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> busybox</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox</span>
<span class="line">      <span class="token key atrule">command</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> sh</span>
<span class="line">        <span class="token punctuation">-</span> <span class="token punctuation">-</span>c</span>
<span class="line">        <span class="token punctuation">-</span> <span class="token string">&quot;echo &#39;容器启动时间:&#39; &amp;&amp; date &amp;&amp; hostname&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 创建并查看日志</span></span>
<span class="line">kubectl create <span class="token parameter variable">-f</span> busybox-pod.yaml</span>
<span class="line">kubectl logs busybox-once</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看 Pod 状态（应为 Completed）</span></span>
<span class="line">kubectl get pods busybox-once</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_7-pod-网络与存储卷-volumes" tabindex="-1"><a class="header-anchor" href="#_7-pod-网络与存储卷-volumes"><span>7. Pod 网络与存储卷（Volumes）</span></a></h2><h3 id="网络特性" tabindex="-1"><a class="header-anchor" href="#网络特性"><span>网络特性</span></a></h3><ul><li>同一个 Pod 内的所有容器共享网络命名空间</li><li>通过 <code>pause</code> 容器（沙盒）提供共享的网络栈</li><li>容器间可通过 <code>localhost</code> 直接通信</li></ul><hr><h3 id="存储卷示例" tabindex="-1"><a class="header-anchor" href="#存储卷示例"><span>存储卷示例</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> shared<span class="token punctuation">-</span>volume<span class="token punctuation">-</span>pod</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">nodeName</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>node<span class="token punctuation">-</span><span class="token number">12</span></span>
<span class="line">  <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>log<span class="token punctuation">-</span>volume</span>
<span class="line">      <span class="token key atrule">hostPath</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">path</span><span class="token punctuation">:</span> /nginx<span class="token punctuation">-</span>logs  <span class="token comment"># 宿主机目录</span></span>
<span class="line">        <span class="token key atrule">type</span><span class="token punctuation">:</span> DirectoryOrCreate</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>log<span class="token punctuation">-</span>volume</span>
<span class="line">          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /var/log/nginx  <span class="token comment"># 容器内挂载路径</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> log<span class="token punctuation">-</span>watcher</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox</span>
<span class="line">      <span class="token key atrule">args</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>/bin/sh<span class="token punctuation">,</span> <span class="token punctuation">-</span>c<span class="token punctuation">,</span> <span class="token string">&#39;tail -f /shared-logs/access.log&#39;</span><span class="token punctuation">]</span></span>
<span class="line">      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>log<span class="token punctuation">-</span>volume</span>
<span class="line">          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /shared<span class="token punctuation">-</span>logs  <span class="token comment"># 同一卷在不同容器中的挂载点</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="存储卷类型对比" tabindex="-1"><a class="header-anchor" href="#存储卷类型对比"><span>存储卷类型对比</span></a></h3><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th><th style="text-align:left;">持久性</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>hostPath</strong></td><td style="text-align:left;">映射到宿主机目录</td><td style="text-align:left;">Pod 删除后数据保留</td></tr><tr><td style="text-align:left;"><strong>emptyDir</strong></td><td style="text-align:left;">临时空目录</td><td style="text-align:left;">Pod 删除后数据丢失</td></tr><tr><td style="text-align:left;"><strong>configMap</strong></td><td style="text-align:left;">配置信息卷</td><td style="text-align:left;">与 ConfigMap 生命周期一致</td></tr><tr><td style="text-align:left;"><strong>secret</strong></td><td style="text-align:left;">敏感信息卷</td><td style="text-align:left;">与 Secret 生命周期一致</td></tr></tbody></table><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 查看字段定义</span></span>
<span class="line">kubectl explain pod.spec.volumes</span>
<span class="line">kubectl explain pod.spec.volumes.hostPath</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_8-多容器-pod-实践" tabindex="-1"><a class="header-anchor" href="#_8-多容器-pod-实践"><span>8. 多容器 Pod 实践</span></a></h2><h3 id="场景-flask-redis-应用" tabindex="-1"><a class="header-anchor" href="#场景-flask-redis-应用"><span>场景：Flask + Redis 应用</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> flask<span class="token punctuation">-</span>redis<span class="token punctuation">-</span>app</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">nodeName</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>node<span class="token punctuation">-</span><span class="token number">11</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> redis</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">6379</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> flask<span class="token punctuation">-</span>app</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>flask<span class="token punctuation">-</span>redis<span class="token punctuation">:</span>latest</span>
<span class="line">      <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent</span>
<span class="line">      <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">5000</span></span>
<span class="line">      <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;python3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/opt/flask-redis.py&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>访问测试：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 获取 Pod IP</span></span>
<span class="line">kubectl get pods flask-redis-app <span class="token parameter variable">-o</span> wide</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 访问 Flask 应用</span></span>
<span class="line"><span class="token function">curl</span> <span class="token operator">&lt;</span>pod-ip<span class="token operator">&gt;</span>:5000</span>
<span class="line"><span class="token comment"># 输出：k8s运行flask程序, 站点访问次数 1 次</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_9-pod-生命周期状态" tabindex="-1"><a class="header-anchor" href="#_9-pod-生命周期状态"><span>9. Pod 生命周期状态</span></a></h2><table><thead><tr><th style="text-align:left;">状态</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Pending</strong></td><td style="text-align:left;">API Server 已创建 Pod，等待调度</td></tr><tr><td style="text-align:left;"><strong>ContainerCreating</strong></td><td style="text-align:left;">正在拉取镜像、创建容器</td></tr><tr><td style="text-align:left;"><strong>Running</strong></td><td style="text-align:left;">至少一个容器处于运行状态</td></tr><tr><td style="text-align:left;"><strong>Succeeded</strong></td><td style="text-align:left;">所有容器成功退出（不再重启）</td></tr><tr><td style="text-align:left;"><strong>Failed</strong></td><td style="text-align:left;">至少一个容器异常退出</td></tr><tr><td style="text-align:left;"><strong>CrashLoopBackOff</strong></td><td style="text-align:left;">容器启动失败，正在重试</td></tr><tr><td style="text-align:left;"><strong>Unknown</strong></td><td style="text-align:left;">无法获取 Pod 状态</td></tr></tbody></table><hr><h2 id="_10-生命周期钩子" tabindex="-1"><a class="header-anchor" href="#_10-生命周期钩子"><span>10. 生命周期钩子</span></a></h2><p>Kubernetes 提供容器生命周期钩子，在特定阶段执行操作。</p><h3 id="poststart-启动后处理" tabindex="-1"><a class="header-anchor" href="#poststart-启动后处理"><span>postStart（启动后处理）</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>poststart</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">lifecycle</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">postStart</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">exec</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;/bin/sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;echo &#39;初始化完成&#39; &gt; /usr/share/nginx/html/status.txt&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="prestop-停止前处理" tabindex="-1"><a class="header-anchor" href="#prestop-停止前处理"><span>preStop（停止前处理）</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>prestop</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> log<span class="token punctuation">-</span>volume</span>
<span class="line">      <span class="token key atrule">hostPath</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">path</span><span class="token punctuation">:</span> /tmp/nginx<span class="token punctuation">-</span>logs</span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">lifecycle</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">preStop</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">exec</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;/bin/sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;echo &#39;Pod 即将终止&#39; &gt; /var/log/nginx/stop.log&quot;</span><span class="token punctuation">]</span></span>
<span class="line">      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> log<span class="token punctuation">-</span>volume</span>
<span class="line">          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /var/log/nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_11-初始化容器-init-containers" tabindex="-1"><a class="header-anchor" href="#_11-初始化容器-init-containers"><span>11. 初始化容器（Init Containers）</span></a></h2><p>在应用容器启动前运行的专用容器，用于执行初始化任务。</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>with<span class="token punctuation">-</span>init</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> html<span class="token punctuation">-</span>volume</span>
<span class="line">      <span class="token key atrule">emptyDir</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">initContainers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> init<span class="token punctuation">-</span>html</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox</span>
<span class="line">      <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;echo &#39;欢迎页面&#39; &gt; /html/index.html&quot;</span><span class="token punctuation">]</span></span>
<span class="line">      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> html<span class="token punctuation">-</span>volume</span>
<span class="line">          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /html</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> html<span class="token punctuation">-</span>volume</span>
<span class="line">          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /usr/share/nginx/html</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>特点</strong>：</p><ul><li>按顺序执行，全部成功后主容器才启动</li><li>执行完成后变为 <code>Terminated</code> 状态，但容器实体保留</li><li>Pod 删除时才彻底清理 init 容器</li></ul><hr><h2 id="_12-健康探针" tabindex="-1"><a class="header-anchor" href="#_12-健康探针"><span>12. 健康探针</span></a></h2><h3 id="存活探针-livenessprobe" tabindex="-1"><a class="header-anchor" href="#存活探针-livenessprobe"><span>存活探针（livenessProbe）</span></a></h3><p>检测容器是否正常运行，失败则重启容器。</p><p><strong>探测方式</strong>：</p><ol><li><strong>httpGet</strong>：发送 HTTP GET 请求</li><li><strong>tcpSocket</strong>：尝试建立 TCP 连接</li><li><strong>exec</strong>：执行容器内命令</li></ol><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>liveness</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">httpGet</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">path</span><span class="token punctuation">:</span> /healthz</span>
<span class="line">          <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">        <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>  <span class="token comment"># 容器启动后5秒开始探测</span></span>
<span class="line">        <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">10</span>       <span class="token comment"># 每10秒探测一次</span></span>
<span class="line">        <span class="token key atrule">timeoutSeconds</span><span class="token punctuation">:</span> <span class="token number">2</span>       <span class="token comment"># 2秒内无响应视为失败</span></span>
<span class="line">        <span class="token key atrule">failureThreshold</span><span class="token punctuation">:</span> <span class="token number">3</span>     <span class="token comment"># 连续失败3次重启容器</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="就绪探针-readinessprobe" tabindex="-1"><a class="header-anchor" href="#就绪探针-readinessprobe"><span>就绪探针（readinessProbe）</span></a></h3><p>检测容器是否准备好接收流量，失败则从 Service 端点移除。</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>readiness</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">readinessProbe</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">httpGet</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">path</span><span class="token punctuation">:</span> /ready</span>
<span class="line">          <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span></span>
<span class="line">        <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">10</span></span>
<span class="line">        <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">5</span></span>
<span class="line">        <span class="token key atrule">successThreshold</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line">        <span class="token key atrule">failureThreshold</span><span class="token punctuation">:</span> <span class="token number">2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_13-资源限制" tabindex="-1"><a class="header-anchor" href="#_13-资源限制"><span>13. 资源限制</span></a></h2><p>通过 <code>resources</code> 字段限制容器的 CPU 和内存使用。</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> limited<span class="token punctuation">-</span>pod</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx</span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">      <span class="token key atrule">resources</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">requests</span><span class="token punctuation">:</span>  <span class="token comment"># 节点必须满足的最小资源</span></span>
<span class="line">          <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">&quot;64Mi&quot;</span></span>
<span class="line">          <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">&quot;250m&quot;</span>  <span class="token comment"># 0.25核</span></span>
<span class="line">        <span class="token key atrule">limits</span><span class="token punctuation">:</span>    <span class="token comment"># 容器最大可使用资源</span></span>
<span class="line">          <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">&quot;128Mi&quot;</span></span>
<span class="line">          <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">&quot;500m&quot;</span>  <span class="token comment"># 0.5核</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>单位说明</strong>：</p><ul><li>CPU：<code>1000m</code> = 1核，<code>250m</code> = 0.25核</li><li>内存：<code>Mi</code> = 兆字节，<code>Gi</code> = 千兆字节</li></ul><hr><h2 id="_14-最佳实践" tabindex="-1"><a class="header-anchor" href="#_14-最佳实践"><span>14. 最佳实践</span></a></h2><h3 id="pod-设计原则" tabindex="-1"><a class="header-anchor" href="#pod-设计原则"><span>Pod 设计原则</span></a></h3><ol><li><strong>单一职责</strong>：一个 Pod 应只包含紧密耦合的容器 <ul><li>适合放一起：Nginx + PHP-FPM，Flask + Redis（Sidecar 模式）</li><li>应分开：应用容器 + 数据库容器</li></ul></li><li><strong>明确探针</strong>：所有生产 Pod 都应配置 livenessProbe 和 readinessProbe</li><li><strong>资源限制</strong>：为每个容器设置合理的 requests 和 limits</li><li><strong>使用标签</strong>：通过标签组织和管理 Pod</li><li><strong>考虑持久化</strong>：重要数据使用持久化存储卷</li></ol><hr><h3 id="调试技巧" tabindex="-1"><a class="header-anchor" href="#调试技巧"><span>调试技巧</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 查看 Pod 完整状态</span></span>
<span class="line">kubectl describe pod <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看容器日志</span></span>
<span class="line">kubectl logs <span class="token operator">&lt;</span>pod<span class="token operator">&gt;</span> <span class="token punctuation">[</span>-c <span class="token operator">&lt;</span>container<span class="token operator">&gt;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 进入容器调试</span></span>
<span class="line">kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token operator">&lt;</span>pod<span class="token operator">&gt;</span> -- <span class="token function">sh</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看资源使用情况</span></span>
<span class="line">kubectl <span class="token function">top</span> pods</span>
<span class="line">kubectl <span class="token function">top</span> pods <span class="token parameter variable">--containers</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 导出 Pod 配置</span></span>
<span class="line">kubectl get pod <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token parameter variable">-o</span> yaml <span class="token operator">&gt;</span> pod-config.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,95)])])}const o=s(p,[["render",t]]),u=JSON.parse('{"path":"/05-%E5%AE%B9%E5%99%A8%E7%BC%96%E6%8E%92/03-kubernetes%E7%BC%96%E6%8E%92/3-k8s%E8%B5%84%E6%BA%90-pod.html","title":"Kubernetes Pod 资源汇总","lang":"zh-CN","frontmatter":{},"git":{"contributors":[{"name":"opsjjq","username":"opsjjq","email":"wangyp987@gmail.com","commits":1,"url":"https://github.com/opsjjq"}],"changelog":[{"hash":"ca8e661b7c6729c958583ed3d1a001b6de398273","time":1771558748000,"email":"wangyp987@gmail.com","author":"opsjjq","message":"222"}]},"filePathRelative":"05-容器编排/03-kubernetes编排/3-k8s资源-pod.md"}');export{o as comp,u as data};
